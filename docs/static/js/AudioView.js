import{c as ve,d as de,r as V,g as Je,a as ee,b as ge,i as ze,w as oe,e as _e,o as xe,f as Ce,n as be,h as d,j as G,t as N,m as X,k as Be,l as qe,p as ie,I as ae,q as Me,s as J,u as ce,v as Pe,x as Ke,y as we,z as le,L as Qe,A as Ue,B as ne,C as Ie,D as et,E as tt,F as ue,G as nt,H as ot,J as Ye,K as Fe,M as at,N as He,O as it,P as st,Q as rt,R as Le,S as te,T as lt,U as ye,V as $e,W as ct,X as Oe}from"./index.js";import{C as ut}from"./index3.js";import"./index4.js";import{F as dt}from"./index5.js";import{s as ft,S as mt,a as vt}from"./index6.js";import{N as ht}from"./index7.js";import{m as Ve,u as Ee,a as gt,P as wt,s as Te}from"./function-call.js";import{u as Ne}from"./use-expose.js";import{L as Ze}from"./index8.js";import{B as yt}from"./index9.js";const[$t,K]=ve("image"),pt={src:String,alt:String,fit:String,position:String,round:Boolean,block:Boolean,width:G,height:G,radius:G,lazyLoad:Boolean,iconSize:G,showError:N,errorIcon:X("photo-fail"),iconPrefix:String,showLoading:N,loadingIcon:X("photo")};var bt=de({name:$t,props:pt,emits:["load","error"],setup(e,{emit:c,slots:f}){const t=V(!1),u=V(!0),D=V(),{$Lazyload:I}=Je().proxy,T=ee(()=>{const y={width:ge(e.width),height:ge(e.height)};return ze(e.radius)&&(y.overflow="hidden",y.borderRadius=ge(e.radius)),y});oe(()=>e.src,()=>{t.value=!1,u.value=!0});const C=y=>{u.value&&(u.value=!1,c("load",y))},l=()=>{const y=new Event("load");Object.defineProperty(y,"target",{value:D.value,enumerable:!0}),C(y)},p=y=>{t.value=!0,u.value=!1,c("error",y)},x=(y,Y,b)=>b?b():d(ae,{name:y,size:e.iconSize,class:Y,classPrefix:e.iconPrefix},null),k=()=>{if(u.value&&e.showLoading)return d("div",{class:K("loading")},[x(e.loadingIcon,K("loading-icon"),f.loading)]);if(t.value&&e.showError)return d("div",{class:K("error")},[x(e.errorIcon,K("error-icon"),f.error)])},O=()=>{if(t.value||!e.src)return;const y={alt:e.alt,class:K("img"),style:{objectFit:e.fit,objectPosition:e.position}};return e.lazyLoad?Be(d("img",ie({ref:D},y),null),[[qe("lazy"),e.src]]):d("img",ie({ref:D,src:e.src,onLoad:C,onError:p},y),null)},A=({el:y})=>{const Y=()=>{y===D.value&&u.value&&l()};D.value?Y():be(Y)},F=({el:y})=>{y===D.value&&!t.value&&p()};return I&&_e&&(I.$on("loaded",A),I.$on("error",F),xe(()=>{I.$off("loaded",A),I.$off("error",F)})),Ce(()=>{be(()=>{var y;(y=D.value)!=null&&y.complete&&!e.lazyLoad&&l()})}),()=>{var y;return d("div",{class:K({round:e.round,block:e.block}),style:T.value},[O(),k(),(y=f.default)==null?void 0:y.call(f)])}}});const je=Me(bt);let Se;const St={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1};let Dt=J({},St);function _t(){({instance:Se}=Ve({setup(){const{state:c,toggle:f}=Ee();return()=>d(ft,ie(c,{"onUpdate:show":f}),null)}}))}function xt(e){return _e?new Promise((c,f)=>{Se||_t(),Se.open(J({},Dt,e,{callback:t=>{(t==="confirm"?c:f)(t)}}))}):Promise.resolve()}const Ct=e=>xt(J({showCancelButton:!0},e)),ke=e=>Math.sqrt((e[0].clientX-e[1].clientX)**2+(e[0].clientY-e[1].clientY)**2),pe=ve("image-preview")[1];var Mt=de({props:{src:String,show:Boolean,active:Number,minZoom:ce(G),maxZoom:ce(G),rootWidth:ce(Number),rootHeight:ce(Number),disableZoom:Boolean},emits:["scale","close","longPress"],setup(e,{emit:c,slots:f}){const t=Pe({scale:1,moveX:0,moveY:0,moving:!1,zooming:!1,imageRatio:0,displayWidth:0,displayHeight:0}),u=gt(),D=V(),I=ee(()=>{const{rootWidth:n,rootHeight:_}=e,M=_/n;return t.imageRatio>M}),T=ee(()=>{const{scale:n,moveX:_,moveY:M,moving:r,zooming:a}=t,o={transitionDuration:a||r?"0s":".3s"};if(n!==1){const m=_/n,s=M/n;o.transform=`scale(${n}, ${n}) translate(${m}px, ${s}px)`}return o}),C=ee(()=>{if(t.imageRatio){const{rootWidth:n,rootHeight:_}=e,M=I.value?_/t.imageRatio:n;return Math.max(0,(t.scale*M-n)/2)}return 0}),l=ee(()=>{if(t.imageRatio){const{rootWidth:n,rootHeight:_}=e,M=I.value?_:n*t.imageRatio;return Math.max(0,(t.scale*M-_)/2)}return 0}),p=n=>{n=le(n,+e.minZoom,+e.maxZoom+1),n!==t.scale&&(t.scale=n,c("scale",{scale:n,index:e.active}))},x=()=>{p(1),t.moveX=0,t.moveY=0},k=()=>{const n=t.scale>1?1:2;p(n),t.moveX=0,t.moveY=0};let O,A,F,y,Y,b,g,i=!1;const w=n=>{const{touches:_}=n;if(O=_.length,O===2&&e.disableZoom)return;const{offsetX:M}=u;u.start(n),A=t.moveX,F=t.moveY,g=Date.now(),i=!1,t.moving=O===1&&t.scale!==1,t.zooming=O===2&&!M.value,t.zooming&&(y=t.scale,Y=ke(n.touches))},S=n=>{const{touches:_}=n;if(u.move(n),t.moving){const{deltaX:M,deltaY:r}=u,a=M.value+A,o=r.value+F;if((a>C.value||a<-C.value)&&!i&&u.isHorizontal()){t.moving=!1;return}i=!0,we(n,!0),t.moveX=le(a,-C.value,C.value),t.moveY=le(o,-l.value,l.value)}if(t.zooming&&(we(n,!0),_.length===2)){const M=ke(_),r=y*M/Y;p(r)}},L=()=>{if(O>1)return;const{offsetX:n,offsetY:_}=u,M=Date.now()-g,r=250,a=5;n.value<a&&_.value<a&&(M<r?b?(clearTimeout(b),b=null,k()):b=setTimeout(()=>{c("close"),b=null},r):M>Qe&&c("longPress"))},z=n=>{let _=!1;if((t.moving||t.zooming)&&(_=!0,t.moving&&A===t.moveX&&F===t.moveY&&(_=!1),!n.touches.length)){t.zooming&&(t.moveX=le(t.moveX,-C.value,C.value),t.moveY=le(t.moveY,-l.value,l.value),t.zooming=!1),t.moving=!1,A=0,F=0,y=1,t.scale<1&&x();const M=+e.maxZoom;t.scale>M&&(t.scale=M)}we(n,_),L(),u.reset()},$=n=>{const{naturalWidth:_,naturalHeight:M}=n.target;t.imageRatio=M/_};return oe(()=>e.active,x),oe(()=>e.show,n=>{n||x()}),Ke("touchmove",S,{target:ee(()=>{var n;return(n=D.value)==null?void 0:n.$el})}),()=>{const n={loading:()=>d(Ze,{type:"spinner"},null)};return d(mt,{ref:D,class:pe("swipe-item"),onTouchstartPassive:w,onTouchend:z,onTouchcancel:z},{default:()=>[f.image?d("div",{class:pe("image-wrap")},[f.image({src:e.src})]):d(je,{src:e.src,fit:"contain",class:pe("image",{vertical:I.value}),style:T.value,onLoad:$},n)]})}}});const[Pt,Q]=ve("image-preview"),It=["show","teleport","transition","overlayStyle","closeOnPopstate"],Lt={show:Boolean,loop:N,images:Ue(),minZoom:ne(1/3),maxZoom:ne(3),overlay:N,closeable:Boolean,showIndex:N,className:Ie,closeIcon:X("clear"),transition:String,beforeClose:Function,overlayClass:Ie,overlayStyle:Object,swipeDuration:ne(300),startPosition:ne(0),showIndicators:Boolean,closeOnPopstate:N,closeIconPosition:X("top-right"),teleport:[String,Object]};var We=de({name:Pt,props:Lt,emits:["scale","close","closed","change","longPress","update:show"],setup(e,{emit:c,slots:f}){const t=V(),u=Pe({active:0,rootWidth:0,rootHeight:0,disableZoom:!1}),D=()=>{if(t.value){const b=nt(t.value.$el);u.rootWidth=b.width,u.rootHeight=b.height,t.value.resize()}},I=b=>c("scale",b),T=b=>c("update:show",b),C=()=>{Ye(e.beforeClose,{args:[u.active],done:()=>T(!1)})},l=b=>{b!==u.active&&(u.active=b,c("change",b))},p=()=>{if(e.showIndex)return d("div",{class:Q("index")},[f.index?f.index({index:u.active}):`${u.active+1} / ${e.images.length}`])},x=()=>{if(f.cover)return d("div",{class:Q("cover")},[f.cover()])},k=()=>{u.disableZoom=!0},O=()=>{u.disableZoom=!1},A=()=>d(vt,{ref:t,lazyRender:!0,loop:e.loop,class:Q("swipe"),duration:e.swipeDuration,initialSwipe:e.startPosition,showIndicators:e.showIndicators,indicatorColor:"white",onChange:l,onDragEnd:O,onDragStart:k},{default:()=>[e.images.map((b,g)=>d(Mt,{src:b,show:e.show,active:u.active,maxZoom:e.maxZoom,minZoom:e.minZoom,rootWidth:u.rootWidth,rootHeight:u.rootHeight,disableZoom:u.disableZoom,onScale:I,onClose:C,onLongPress:()=>c("longPress",{index:g})},{image:f.image}))]}),F=()=>{if(e.closeable)return d(ae,{role:"button",name:e.closeIcon,class:[Q("close-icon",e.closeIconPosition),ot],onClick:C},null)},y=()=>c("closed"),Y=(b,g)=>{var i;return(i=t.value)==null?void 0:i.swipeTo(b,g)};return Ne({swipeTo:Y}),Ce(D),oe([et,tt],D),oe(()=>e.startPosition,b=>l(+b)),oe(()=>e.show,b=>{const{images:g,startPosition:i}=e;b?(l(+i),be(()=>{D(),Y(+i,{immediate:!0})})):c("close",{index:u.active,url:g[u.active]})}),()=>d(wt,ie({class:[Q(),e.className],overlayClass:[Q("overlay"),e.overlayClass],onClosed:y,"onUpdate:show":T},ue(e,It)),{default:()=>[F(),A(),p(),x()]})}});let me;const Ot={loop:!0,images:[],maxZoom:3,minZoom:1/3,onScale:void 0,onClose:void 0,onChange:void 0,teleport:"body",className:"",showIndex:!0,closeable:!1,closeIcon:"clear",transition:void 0,beforeClose:void 0,overlayStyle:void 0,overlayClass:void 0,startPosition:0,swipeDuration:300,showIndicators:!1,closeOnPopstate:!0,closeIconPosition:"top-right"};function Tt(){({instance:me}=Ve({setup(){const{state:e,toggle:c}=Ee(),f=()=>{e.images=[]};return()=>d(We,ie(e,{onClosed:f,"onUpdate:show":c}),null)}}))}const kt=(e,c=0)=>{if(_e)return me||Tt(),e=Array.isArray(e)?{images:e,startPosition:c}:e,me.open(J({},Ot,e)),me};Me(We);const[Rt,U,At]=ve("uploader");function Re(e,c){return new Promise(f=>{if(c==="file"){f();return}const t=new FileReader;t.onload=u=>{f(u.target.result)},c==="dataUrl"?t.readAsDataURL(e):c==="text"&&t.readAsText(e)})}function Xe(e,c){return Fe(e).some(f=>f.file?at(c)?c(f.file):f.file.size>+c:!1)}function zt(e,c){const f=[],t=[];return e.forEach(u=>{Xe(u,c)?t.push(u):f.push(u)}),{valid:f,invalid:t}}const Bt=/\.(jpeg|jpg|gif|png|svg|webp|jfif|bmp|dpg|avif)/i,Ut=e=>Bt.test(e);function Ge(e){return e.isImage?!0:e.file&&e.file.type?e.file.type.indexOf("image")===0:e.url?Ut(e.url):typeof e.content=="string"?e.content.indexOf("data:image")===0:!1}var Yt=de({props:{name:G,item:ce(Object),index:Number,imageFit:String,lazyLoad:Boolean,deletable:Boolean,previewSize:[Number,String,Array],beforeDelete:Function},emits:["delete","preview"],setup(e,{emit:c,slots:f}){const t=()=>{const{status:l,message:p}=e.item;if(l==="uploading"||l==="failed"){const x=l==="failed"?d(ae,{name:"close",class:U("mask-icon")},null):d(Ze,{class:U("loading")},null),k=ze(p)&&p!=="";return d("div",{class:U("mask")},[x,k&&d("div",{class:U("mask-message")},[p])])}},u=l=>{const{name:p,item:x,index:k,beforeDelete:O}=e;l.stopPropagation(),Ye(O,{args:[x,{name:p,index:k}],done:()=>c("delete")})},D=()=>c("preview"),I=()=>{if(e.deletable&&e.item.status!=="uploading"){const l=f["preview-delete"];return d("div",{role:"button",class:U("preview-delete",{shadow:!l}),tabindex:0,"aria-label":At("delete"),onClick:u},[l?l():d(ae,{name:"cross",class:U("preview-delete-icon")},null)])}},T=()=>{if(f["preview-cover"]){const{index:l,item:p}=e;return d("div",{class:U("preview-cover")},[f["preview-cover"](J({index:l},p))])}},C=()=>{const{item:l,lazyLoad:p,imageFit:x,previewSize:k}=e;return Ge(l)?d(je,{fit:x,src:l.content||l.url,class:U("preview-image"),width:Array.isArray(k)?k[0]:k,height:Array.isArray(k)?k[1]:k,lazyLoad:p,onClick:D},{default:T}):d("div",{class:U("file"),style:He(e.previewSize)},[d(ae,{class:U("file-icon"),name:"description"},null),d("div",{class:[U("file-name"),"van-ellipsis"]},[l.file?l.file.name:l.url]),T()])};return()=>d("div",{class:U("preview")},[C(),t(),I()])}});const Ft={name:ne(""),accept:X("image/*"),capture:String,multiple:Boolean,disabled:Boolean,readonly:Boolean,lazyLoad:Boolean,maxCount:ne(1/0),imageFit:X("cover"),resultType:X("dataUrl"),uploadIcon:X("photograph"),uploadText:String,deletable:N,afterRead:Function,showUpload:N,modelValue:Ue(),beforeRead:Function,beforeDelete:Function,previewSize:[Number,String,Array],previewImage:N,previewOptions:Object,previewFullImage:N,maxSize:{type:[Number,String,Function],default:1/0}};var Ht=de({name:Rt,props:Ft,emits:["delete","oversize","clickUpload","closePreview","clickPreview","update:modelValue"],setup(e,{emit:c,slots:f}){const t=V(),u=[],D=(i=e.modelValue.length)=>({name:e.name,index:i}),I=()=>{t.value&&(t.value.value="")},T=i=>{if(I(),Xe(i,e.maxSize))if(Array.isArray(i)){const w=zt(i,e.maxSize);if(i=w.valid,c("oversize",w.invalid,D()),!i.length)return}else{c("oversize",i,D());return}i=Pe(i),c("update:modelValue",[...e.modelValue,...Fe(i)]),e.afterRead&&e.afterRead(i,D())},C=i=>{const{maxCount:w,modelValue:S,resultType:L}=e;if(Array.isArray(i)){const z=+w-S.length;i.length>z&&(i=i.slice(0,z)),Promise.all(i.map($=>Re($,L))).then($=>{const n=i.map((_,M)=>{const r={file:_,status:"",message:""};return $[M]&&(r.content=$[M]),r});T(n)})}else Re(i,L).then(z=>{const $={file:i,status:"",message:""};z&&($.content=z),T($)})},l=i=>{const{files:w}=i.target;if(e.disabled||!w||!w.length)return;const S=w.length===1?w[0]:[].slice.call(w);if(e.beforeRead){const L=e.beforeRead(S,D());if(!L){I();return}if(rt(L)){L.then(z=>{C(z||S)}).catch(I);return}}C(S)};let p;const x=()=>c("closePreview"),k=i=>{if(e.previewFullImage){const w=e.modelValue.filter(Ge),S=w.map(L=>(L.file&&!L.url&&L.status!=="failed"&&(L.url=URL.createObjectURL(L.file),u.push(L.url)),L.url)).filter(Boolean);p=kt(J({images:S,startPosition:w.indexOf(i),onClose:x},e.previewOptions))}},O=()=>{p&&p.close()},A=(i,w)=>{const S=e.modelValue.slice(0);S.splice(w,1),c("update:modelValue",S),c("delete",i,D(w))},F=(i,w)=>{const S=["imageFit","deletable","previewSize","beforeDelete"],L=J(ue(e,S),ue(i,S,!0));return d(Yt,ie({item:i,index:w,onClick:()=>c("clickPreview",i,D(w)),onDelete:()=>A(i,w),onPreview:()=>k(i)},ue(e,["name","lazyLoad"]),L),ue(f,["preview-cover","preview-delete"]))},y=()=>{if(e.previewImage)return e.modelValue.map(F)},Y=i=>c("clickUpload",i),b=()=>{if(e.modelValue.length>=+e.maxCount)return;const i=e.readonly?null:d("input",{ref:t,type:"file",class:U("input"),accept:e.accept,capture:e.capture,multiple:e.multiple,disabled:e.disabled,onChange:l},null);return f.default?d("div",{class:U("input-wrapper"),onClick:Y},[f.default(),i]):Be(d("div",{class:U("upload",{readonly:e.readonly}),style:He(e.previewSize),onClick:Y},[d(ae,{name:e.uploadIcon,class:U("upload-icon")},null),e.uploadText&&d("span",{class:U("upload-text")},[e.uploadText]),i]),[[st,e.showUpload]])},g=()=>{t.value&&!e.disabled&&t.value.click()};return xe(()=>{u.forEach(i=>URL.revokeObjectURL(i))}),Ne({chooseFile:g,closeImagePreview:O}),it(()=>e.modelValue),()=>d("div",{class:U()},[d("div",{class:U("wrapper",{disabled:e.disabled})},[y(),b()])])}});const Vt=Me(Ht);var Et=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},De={},Nt={get exports(){return De},set exports(e){De=e}};(function(e,c){(function(f,t){e.exports=t()})(Et,function(){var f=1e3,t=6e4,u=36e5,D="millisecond",I="second",T="minute",C="hour",l="day",p="week",x="month",k="quarter",O="year",A="date",F="Invalid Date",y=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,Y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,b={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(r){var a=["th","st","nd","rd"],o=r%100;return"["+r+(a[(o-20)%10]||a[o]||a[0])+"]"}},g=function(r,a,o){var m=String(r);return!m||m.length>=a?r:""+Array(a+1-m.length).join(o)+r},i={s:g,z:function(r){var a=-r.utcOffset(),o=Math.abs(a),m=Math.floor(o/60),s=o%60;return(a<=0?"+":"-")+g(m,2,"0")+":"+g(s,2,"0")},m:function r(a,o){if(a.date()<o.date())return-r(o,a);var m=12*(o.year()-a.year())+(o.month()-a.month()),s=a.clone().add(m,x),h=o-s<0,v=a.clone().add(m+(h?-1:1),x);return+(-(m+(o-s)/(h?s-v:v-s))||0)},a:function(r){return r<0?Math.ceil(r)||0:Math.floor(r)},p:function(r){return{M:x,y:O,w:p,d:l,D:A,h:C,m:T,s:I,ms:D,Q:k}[r]||String(r||"").toLowerCase().replace(/s$/,"")},u:function(r){return r===void 0}},w="en",S={};S[w]=b;var L=function(r){return r instanceof _},z=function r(a,o,m){var s;if(!a)return w;if(typeof a=="string"){var h=a.toLowerCase();S[h]&&(s=h),o&&(S[h]=o,s=h);var v=a.split("-");if(!s&&v.length>1)return r(v[0])}else{var P=a.name;S[P]=a,s=P}return!m&&s&&(w=s),s||!m&&w},$=function(r,a){if(L(r))return r.clone();var o=typeof a=="object"?a:{};return o.date=r,o.args=arguments,new _(o)},n=i;n.l=z,n.i=L,n.w=function(r,a){return $(r,{locale:a.$L,utc:a.$u,x:a.$x,$offset:a.$offset})};var _=function(){function r(o){this.$L=z(o.locale,null,!0),this.parse(o)}var a=r.prototype;return a.parse=function(o){this.$d=function(m){var s=m.date,h=m.utc;if(s===null)return new Date(NaN);if(n.u(s))return new Date;if(s instanceof Date)return new Date(s);if(typeof s=="string"&&!/Z$/i.test(s)){var v=s.match(y);if(v){var P=v[2]-1||0,B=(v[7]||"0").substring(0,3);return h?new Date(Date.UTC(v[1],P,v[3]||1,v[4]||0,v[5]||0,v[6]||0,B)):new Date(v[1],P,v[3]||1,v[4]||0,v[5]||0,v[6]||0,B)}}return new Date(s)}(o),this.$x=o.x||{},this.init()},a.init=function(){var o=this.$d;this.$y=o.getFullYear(),this.$M=o.getMonth(),this.$D=o.getDate(),this.$W=o.getDay(),this.$H=o.getHours(),this.$m=o.getMinutes(),this.$s=o.getSeconds(),this.$ms=o.getMilliseconds()},a.$utils=function(){return n},a.isValid=function(){return this.$d.toString()!==F},a.isSame=function(o,m){var s=$(o);return this.startOf(m)<=s&&s<=this.endOf(m)},a.isAfter=function(o,m){return $(o)<this.startOf(m)},a.isBefore=function(o,m){return this.endOf(m)<$(o)},a.$g=function(o,m,s){return n.u(o)?this[m]:this.set(s,o)},a.unix=function(){return Math.floor(this.valueOf()/1e3)},a.valueOf=function(){return this.$d.getTime()},a.startOf=function(o,m){var s=this,h=!!n.u(m)||m,v=n.p(o),P=function(q,E){var W=n.w(s.$u?Date.UTC(s.$y,E,q):new Date(s.$y,E,q),s);return h?W:W.endOf(l)},B=function(q,E){return n.w(s.toDate()[q].apply(s.toDate("s"),(h?[0,0,0,0]:[23,59,59,999]).slice(E)),s)},R=this.$W,H=this.$M,j=this.$D,Z="set"+(this.$u?"UTC":"");switch(v){case O:return h?P(1,0):P(31,11);case x:return h?P(1,H):P(0,H+1);case p:var se=this.$locale().weekStart||0,re=(R<se?R+7:R)-se;return P(h?j-re:j+(6-re),H);case l:case A:return B(Z+"Hours",0);case C:return B(Z+"Minutes",1);case T:return B(Z+"Seconds",2);case I:return B(Z+"Milliseconds",3);default:return this.clone()}},a.endOf=function(o){return this.startOf(o,!1)},a.$set=function(o,m){var s,h=n.p(o),v="set"+(this.$u?"UTC":""),P=(s={},s[l]=v+"Date",s[A]=v+"Date",s[x]=v+"Month",s[O]=v+"FullYear",s[C]=v+"Hours",s[T]=v+"Minutes",s[I]=v+"Seconds",s[D]=v+"Milliseconds",s)[h],B=h===l?this.$D+(m-this.$W):m;if(h===x||h===O){var R=this.clone().set(A,1);R.$d[P](B),R.init(),this.$d=R.set(A,Math.min(this.$D,R.daysInMonth())).$d}else P&&this.$d[P](B);return this.init(),this},a.set=function(o,m){return this.clone().$set(o,m)},a.get=function(o){return this[n.p(o)]()},a.add=function(o,m){var s,h=this;o=Number(o);var v=n.p(m),P=function(H){var j=$(h);return n.w(j.date(j.date()+Math.round(H*o)),h)};if(v===x)return this.set(x,this.$M+o);if(v===O)return this.set(O,this.$y+o);if(v===l)return P(1);if(v===p)return P(7);var B=(s={},s[T]=t,s[C]=u,s[I]=f,s)[v]||1,R=this.$d.getTime()+o*B;return n.w(R,this)},a.subtract=function(o,m){return this.add(-1*o,m)},a.format=function(o){var m=this,s=this.$locale();if(!this.isValid())return s.invalidDate||F;var h=o||"YYYY-MM-DDTHH:mm:ssZ",v=n.z(this),P=this.$H,B=this.$m,R=this.$M,H=s.weekdays,j=s.months,Z=function(E,W,he,fe){return E&&(E[W]||E(m,h))||he[W].slice(0,fe)},se=function(E){return n.s(P%12||12,E,"0")},re=s.meridiem||function(E,W,he){var fe=E<12?"AM":"PM";return he?fe.toLowerCase():fe},q={YY:String(this.$y).slice(-2),YYYY:this.$y,M:R+1,MM:n.s(R+1,2,"0"),MMM:Z(s.monthsShort,R,j,3),MMMM:Z(j,R),D:this.$D,DD:n.s(this.$D,2,"0"),d:String(this.$W),dd:Z(s.weekdaysMin,this.$W,H,2),ddd:Z(s.weekdaysShort,this.$W,H,3),dddd:H[this.$W],H:String(P),HH:n.s(P,2,"0"),h:se(1),hh:se(2),a:re(P,B,!0),A:re(P,B,!1),m:String(B),mm:n.s(B,2,"0"),s:String(this.$s),ss:n.s(this.$s,2,"0"),SSS:n.s(this.$ms,3,"0"),Z:v};return h.replace(Y,function(E,W){return W||q[E]||v.replace(":","")})},a.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},a.diff=function(o,m,s){var h,v=n.p(m),P=$(o),B=(P.utcOffset()-this.utcOffset())*t,R=this-P,H=n.m(this,P);return H=(h={},h[O]=H/12,h[x]=H,h[k]=H/3,h[p]=(R-B)/6048e5,h[l]=(R-B)/864e5,h[C]=R/u,h[T]=R/t,h[I]=R/f,h)[v]||R,s?H:n.a(H)},a.daysInMonth=function(){return this.endOf(x).$D},a.$locale=function(){return S[this.$L]},a.locale=function(o,m){if(!o)return this.$L;var s=this.clone(),h=z(o,m,!0);return h&&(s.$L=h),s},a.clone=function(){return n.w(this.$d,this)},a.toDate=function(){return new Date(this.valueOf())},a.toJSON=function(){return this.isValid()?this.toISOString():null},a.toISOString=function(){return this.$d.toISOString()},a.toString=function(){return this.$d.toUTCString()},r}(),M=_.prototype;return $.prototype=M,[["$ms",D],["$s",I],["$m",T],["$H",C],["$W",l],["$M",x],["$y",O],["$D",A]].forEach(function(r){M[r[1]]=function(a){return this.$g(a,r[0],r[1])}}),$.extend=function(r,a){return r.$i||(r(a,_,$),r.$i=!0),$},$.locale=z,$.isDayjs=L,$.unix=function(r){return $(1e3*r)},$.en=S[w],$.Ls=S,$.p={},$})})(Nt);const Ae=De;const Zt={class:"home text-center"},jt={class:"upload-box"},Wt=te("p",{class:"mg10"},"请上传音频文件：",-1),Xt={key:0,class:"audio-resouse"},Gt=["src"],Jt={class:"audition"},qt=["src"],cn={__name:"AudioView",setup(e){const c=V(""),f=V(null),t=V(""),u=V(""),D=V([]),I=V(""),T=V(null),C=V(null),l=new(window.AudioContext||window.webkitAudioContext),p=V(null);V(null),Ce(()=>{x()});const x=()=>{c.value=Ae().format("YYYY-MM-DD HH:mm:ss"),f.value=setInterval(()=>{c.value=Ae().format("YYYY-MM-DD HH:mm:ss")},1e3)},k=()=>{Ct({title:"下载提示",message:"确实要下载吗？下载后请前往文件目录查看！！！"}).then(()=>{Te("下载");const g=D.value[0];O(g.file)}).catch(()=>{Te("取消下载")})},O=async g=>{if(g){const i=new Blob([g]),w=window.URL.createObjectURL(i),S=document.createElement("a");S.href=w,S.setAttribute("download",g.name),document.body.appendChild(S),S.click(),window.URL.revokeObjectURL(w),document.body.removeChild(S);return}},A=g=>(console.log(g,"file上传中"),g.status="uploading",g.message="上传中...",!0),F=g=>{console.log(g,"file上传成功"),u.value=g.file.name,t.value=URL.createObjectURL(g.file),Y(g.file)},y=g=>{console.log(g,"file上传成功"),u.value="",t.value="",D.value=[]},Y=g=>{if(!g)return;const i=new FileReader;i.onload=async()=>{const w=i.result;p.value=await l.decodeAudioData(w)},i.readAsArrayBuffer(g)},b=async(g,i)=>{if(!p.value)return;const w=l.createBufferSource();w.buffer=p.value;const S=i-g;w.connect(l.destination),w.start(l.currentTime,g,S),l.createMediaStreamDestination(),console.log(l,"audioContext");const L=p.value.getChannelData(0),z=l.sampleRate*g,$=l.sampleRate*i;if($>p.value.length){alert("结束时间超出音频长度");return}const n=L.subarray(z,$),_=l.createBuffer(1,n.length,l.sampleRate);_.getChannelData(0).set(n);const M=_.getChannelData(0),r=new Blob([M],{type:"audio/mp3"});I.value=URL.createObjectURL(r)};return xe(()=>{clearInterval(f)}),(g,i)=>{const w=ht,S=Vt,L=dt,z=ut,$=yt;return Oe(),Le("div",Zt,[d(w,{"left-icon":"volume-o",text:`当前时间：${c.value}`},null,8,["text"]),te("div",jt,[Wt,d(S,{modelValue:D.value,"onUpdate:modelValue":i[0]||(i[0]=n=>D.value=n),"max-count":1,"before-read":A,"after-read":F,"before-delete":y,accept:"audio/mp3"},null,8,["modelValue"])]),t.value?(Oe(),Le("div",Xt,[te("span",null,lt(u.value),1),te("audio",{src:t.value,controls:"",autoplay:!1},null,8,Gt),d(z,{inset:""},{default:ye(()=>[d(L,{modelValue:T.value,"onUpdate:modelValue":i[1]||(i[1]=n=>T.value=n),type:"number",colon:"",placeholder:"请输入开始时间",label:"开始时间/秒"},null,8,["modelValue"]),d(L,{modelValue:C.value,"onUpdate:modelValue":i[2]||(i[2]=n=>C.value=n),type:"number",colon:"",placeholder:"请输入结束时间",label:"结束时间/秒"},null,8,["modelValue"])]),_:1}),d($,{type:"success",onClick:i[3]||(i[3]=n=>b(T.value,C.value))},{default:ye(()=>[$e("截取片段")]),_:1}),te("p",Jt,[$e(" 试听： "),te("audio",{src:I.value,controls:"",autoplay:"false"},null,8,qt)]),d($,{type:"success",onClick:k},{default:ye(()=>[$e("下载")]),_:1})])):ct("",!0)])}}};export{cn as default};
