import{c as ce,t as j,n as J,m as K,d as ne,r as V,a as he,u as it,b as W,w as G,e as Fe,f as Ue,g as st,o as ge,h as lt,i as rt,j as ut,k as xe,l as Ee,p,q as pe,s as ke,v as me,x as be,y as ee,z as we,A as ct,B as dt,C as _e,D as Ne,E as Oe,F as te,G as Ve,H as ft,I as re,J as le,K as ue,L as fe,M as vt,N as He,O as Ae,P as ve,Q as mt,R as ht,S as We,T as Ze,U as gt,V as je,W as wt,X as yt,Y as pt,_ as $t,Z as Re,$ as ze,a0 as oe,a1 as bt,a2 as Pe,a3 as Me,a4 as St}from"./index.js";import{C as xt}from"./index3.js";import"./index4.js";import{F as Ct}from"./index5.js";import{s as Dt}from"./index6.js";import{N as _t}from"./index7.js";import{u as Ce}from"./use-expose.js";import{u as Xe,m as Ge,a as qe,P as Pt,s as de}from"./function-call.js";import{L as Je}from"./index8.js";import{B as Mt}from"./index9.js";const[Ke,$e]=ce("swipe"),It={loop:j,width:J,height:J,vertical:Boolean,autoplay:K(0),duration:K(500),touchable:j,lazyRender:Boolean,initialSwipe:K(0),indicatorColor:String,showIndicators:j,stopPropagation:j},Qe=Symbol(Ke);var Tt=ne({name:Ke,props:It,emits:["change","dragStart","dragEnd"],setup(e,{emit:g,slots:w}){const t=V(),d=V(),s=he({rect:null,width:0,height:0,offset:0,active:0,swiping:!1});let T=!1;const O=Xe(),{children:M,linkChildren:v}=it(Qe),f=W(()=>M.length),y=W(()=>s[e.vertical?"height":"width"]),k=W(()=>e.vertical?O.deltaY.value:O.deltaX.value),R=W(()=>s.rect?(e.vertical?s.rect.height:s.rect.width)-y.value*f.value:0),L=W(()=>y.value?Math.ceil(Math.abs(R.value)/y.value):f.value),U=W(()=>f.value*y.value),S=W(()=>(s.active+f.value)%f.value),E=W(()=>{const c=e.vertical?"vertical":"horizontal";return O.direction.value===c}),A=W(()=>{const c={transitionDuration:`${s.swiping?0:e.duration}ms`,transform:`translate${e.vertical?"Y":"X"}(${s.offset}px)`};if(y.value){const D=e.vertical?"height":"width",I=e.vertical?"width":"height";c[D]=`${U.value}px`,c[I]=e[I]?`${e[I]}px`:""}return c}),H=c=>{const{active:D}=s;return c?e.loop?ee(D+c,-1,f.value):ee(D+c,0,L.value):D},m=(c,D=0)=>{let I=c*y.value;e.loop||(I=Math.min(I,-R.value));let F=D-I;return e.loop||(F=ee(F,R.value,0)),F},_=({pace:c=0,offset:D=0,emitChange:I})=>{if(f.value<=1)return;const{active:F}=s,Y=H(c),X=m(Y,D);if(e.loop){if(M[0]&&X!==R.value){const q=X<R.value;M[0].setOffset(q?U.value:0)}if(M[f.value-1]&&X!==0){const q=X>0;M[f.value-1].setOffset(q?-U.value:0)}}s.active=Y,s.offset=X,I&&Y!==F&&g("change",S.value)},r=()=>{s.swiping=!0,s.active<=-1?_({pace:f.value}):s.active>=f.value&&_({pace:-f.value})},u=()=>{r(),O.reset(),pe(()=>{s.swiping=!1,_({pace:-1,emitChange:!0})})},z=()=>{r(),O.reset(),pe(()=>{s.swiping=!1,_({pace:1,emitChange:!0})})};let P;const a=()=>clearTimeout(P),b=()=>{a(),+e.autoplay>0&&f.value>1&&(P=setTimeout(()=>{z(),b()},+e.autoplay))},$=(c=+e.initialSwipe)=>{if(!t.value)return;const D=()=>{var I,F;if(!ke(t)){const Y={width:t.value.offsetWidth,height:t.value.offsetHeight};s.rect=Y,s.width=+((I=e.width)!=null?I:Y.width),s.height=+((F=e.height)!=null?F:Y.height)}f.value&&(c=Math.min(f.value-1,c),c===-1&&(c=f.value-1)),s.active=c,s.swiping=!0,s.offset=m(c),M.forEach(Y=>{Y.setOffset(0)}),b()};ke(t)?me().then(D):D()},l=()=>$(s.active);let n;const o=c=>{!e.touchable||c.touches.length>1||(O.start(c),T=!1,n=Date.now(),a(),r())},h=c=>{e.touchable&&s.swiping&&(O.move(c),E.value&&(!e.loop&&(s.active===0&&k.value>0||s.active===f.value-1&&k.value<0)||(be(c,e.stopPropagation),_({offset:k.value}),T||(g("dragStart",{index:S.value}),T=!0))))},i=()=>{if(!e.touchable||!s.swiping)return;const c=Date.now()-n,D=k.value/c;if((Math.abs(D)>.25||Math.abs(k.value)>y.value/2)&&E.value){const F=e.vertical?O.offsetY.value:O.offsetX.value;let Y=0;e.loop?Y=F>0?k.value>0?-1:1:0:Y=-Math[k.value>0?"ceil":"floor"](k.value/y.value),_({pace:Y,emitChange:!0})}else k.value&&_({pace:0});T=!1,s.swiping=!1,g("dragEnd",{index:S.value}),b()},C=(c,D={})=>{r(),O.reset(),pe(()=>{let I;e.loop&&c===f.value?I=s.active===0?0:c:I=c%f.value,D.immediate?pe(()=>{s.swiping=!1}):s.swiping=!1,_({pace:I-s.active,emitChange:!0})})},x=(c,D)=>{const I=D===S.value,F=I?{backgroundColor:e.indicatorColor}:void 0;return p("i",{style:F,class:$e("indicator",{active:I})},null)},B=()=>{if(w.indicator)return w.indicator({active:S.value,total:f.value});if(e.showIndicators&&f.value>1)return p("div",{class:$e("indicators",{vertical:e.vertical})},[Array(f.value).fill("").map(x)])};return Ce({prev:u,next:z,state:s,resize:l,swipeTo:C}),v({size:y,props:e,count:f,activeIndicator:S}),G(()=>e.initialSwipe,c=>$(+c)),G(f,()=>$(s.active)),G(()=>e.autoplay,b),G([Fe,Ue,()=>e.width,()=>e.height],l),G(st(),c=>{c==="visible"?b():a()}),ge($),lt(()=>$(s.active)),rt(()=>$(s.active)),ut(a),xe(a),Ee("touchmove",h,{target:d}),()=>{var c;return p("div",{ref:t,class:$e()},[p("div",{ref:d,style:A.value,class:$e("track",{vertical:e.vertical}),onTouchstartPassive:o,onTouchend:i,onTouchcancel:i},[(c=w.default)==null?void 0:c.call(w)]),B()])}}});const Ot=we(Tt),[kt,At]=ce("swipe-item");var Rt=ne({name:kt,setup(e,{slots:g}){let w;const t=he({offset:0,inited:!1,mounted:!1}),{parent:d,index:s}=ct(Qe);if(!d)return;const T=W(()=>{const v={},{vertical:f}=d.props;return d.size.value&&(v[f?"height":"width"]=`${d.size.value}px`),t.offset&&(v.transform=`translate${f?"Y":"X"}(${t.offset}px)`),v}),O=W(()=>{const{loop:v,lazyRender:f}=d.props;if(!f||w)return!0;if(!t.mounted)return!1;const y=d.activeIndicator.value,k=d.count.value-1,R=y===0&&v?k:y-1,L=y===k&&v?0:y+1;return w=s.value===y||s.value===R||s.value===L,w}),M=v=>{t.offset=v};return ge(()=>{me(()=>{t.mounted=!0})}),Ce({setOffset:M}),()=>{var v;return p("div",{class:At(),style:T.value},[O.value?(v=g.default)==null?void 0:v.call(g):null])}}});const zt=we(Rt),[Bt,ie]=ce("image"),Lt={src:String,alt:String,fit:String,position:String,round:Boolean,block:Boolean,width:J,height:J,radius:J,lazyLoad:Boolean,iconSize:J,showError:j,errorIcon:te("photo-fail"),iconPrefix:String,showLoading:j,loadingIcon:te("photo")};var Yt=ne({name:Bt,props:Lt,emits:["load","error"],setup(e,{emit:g,slots:w}){const t=V(!1),d=V(!0),s=V(),{$Lazyload:T}=dt().proxy,O=W(()=>{const S={width:_e(e.width),height:_e(e.height)};return Ne(e.radius)&&(S.overflow="hidden",S.borderRadius=_e(e.radius)),S});G(()=>e.src,()=>{t.value=!1,d.value=!0});const M=S=>{d.value&&(d.value=!1,g("load",S))},v=()=>{const S=new Event("load");Object.defineProperty(S,"target",{value:s.value,enumerable:!0}),M(S)},f=S=>{t.value=!0,d.value=!1,g("error",S)},y=(S,E,A)=>A?A():p(le,{name:S,size:e.iconSize,class:E,classPrefix:e.iconPrefix},null),k=()=>{if(d.value&&e.showLoading)return p("div",{class:ie("loading")},[y(e.loadingIcon,ie("loading-icon"),w.loading)]);if(t.value&&e.showError)return p("div",{class:ie("error")},[y(e.errorIcon,ie("error-icon"),w.error)])},R=()=>{if(t.value||!e.src)return;const S={alt:e.alt,class:ie("img"),style:{objectFit:e.fit,objectPosition:e.position}};return e.lazyLoad?Ve(p("img",re({ref:s},S),null),[[ft("lazy"),e.src]]):p("img",re({ref:s,src:e.src,onLoad:M,onError:f},S),null)},L=({el:S})=>{const E=()=>{S===s.value&&d.value&&v()};s.value?E():me(E)},U=({el:S})=>{S===s.value&&!t.value&&f()};return T&&Oe&&(T.$on("loaded",L),T.$on("error",U),xe(()=>{T.$off("loaded",L),T.$off("error",U)})),ge(()=>{me(()=>{var S;(S=s.value)!=null&&S.complete&&!e.lazyLoad&&v()})}),()=>{var S;return p("div",{class:ie({round:e.round,block:e.block}),style:O.value},[R(),k(),(S=w.default)==null?void 0:S.call(w)])}}});const et=we(Yt);let Te;const Ft={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1};let Ut=ue({},Ft);function Et(){({instance:Te}=Ge({setup(){const{state:g,toggle:w}=qe();return()=>p(Dt,re(g,{"onUpdate:show":w}),null)}}))}function Nt(e){return Oe?new Promise((g,w)=>{Te||Et(),Te.open(ue({},Ut,e,{callback:t=>{(t==="confirm"?g:w)(t)}}))}):Promise.resolve()}const Be=e=>Math.sqrt((e[0].clientX-e[1].clientX)**2+(e[0].clientY-e[1].clientY)**2),Ie=ce("image-preview")[1];var Vt=ne({props:{src:String,show:Boolean,active:Number,minZoom:fe(J),maxZoom:fe(J),rootWidth:fe(Number),rootHeight:fe(Number),disableZoom:Boolean},emits:["scale","close","longPress"],setup(e,{emit:g,slots:w}){const t=he({scale:1,moveX:0,moveY:0,moving:!1,zooming:!1,imageRatio:0,displayWidth:0,displayHeight:0}),d=Xe(),s=V(),T=W(()=>{const{rootWidth:a,rootHeight:b}=e,$=b/a;return t.imageRatio>$}),O=W(()=>{const{scale:a,moveX:b,moveY:$,moving:l,zooming:n}=t,o={transitionDuration:n||l?"0s":".3s"};if(a!==1){const h=b/a,i=$/a;o.transform=`scale(${a}, ${a}) translate(${h}px, ${i}px)`}return o}),M=W(()=>{if(t.imageRatio){const{rootWidth:a,rootHeight:b}=e,$=T.value?b/t.imageRatio:a;return Math.max(0,(t.scale*$-a)/2)}return 0}),v=W(()=>{if(t.imageRatio){const{rootWidth:a,rootHeight:b}=e,$=T.value?b:a*t.imageRatio;return Math.max(0,(t.scale*$-b)/2)}return 0}),f=a=>{a=ee(a,+e.minZoom,+e.maxZoom+1),a!==t.scale&&(t.scale=a,g("scale",{scale:a,index:e.active}))},y=()=>{f(1),t.moveX=0,t.moveY=0},k=()=>{const a=t.scale>1?1:2;f(a),t.moveX=0,t.moveY=0};let R,L,U,S,E,A,H,m=!1;const _=a=>{const{touches:b}=a;if(R=b.length,R===2&&e.disableZoom)return;const{offsetX:$}=d;d.start(a),L=t.moveX,U=t.moveY,H=Date.now(),m=!1,t.moving=R===1&&t.scale!==1,t.zooming=R===2&&!$.value,t.zooming&&(S=t.scale,E=Be(a.touches))},r=a=>{const{touches:b}=a;if(d.move(a),t.moving){const{deltaX:$,deltaY:l}=d,n=$.value+L,o=l.value+U;if((n>M.value||n<-M.value)&&!m&&d.isHorizontal()){t.moving=!1;return}m=!0,be(a,!0),t.moveX=ee(n,-M.value,M.value),t.moveY=ee(o,-v.value,v.value)}if(t.zooming&&(be(a,!0),b.length===2)){const $=Be(b),l=S*$/E;f(l)}},u=()=>{if(R>1)return;const{offsetX:a,offsetY:b}=d,$=Date.now()-H,l=250,n=5;a.value<n&&b.value<n&&($<l?A?(clearTimeout(A),A=null,k()):A=setTimeout(()=>{g("close"),A=null},l):$>vt&&g("longPress"))},z=a=>{let b=!1;if((t.moving||t.zooming)&&(b=!0,t.moving&&L===t.moveX&&U===t.moveY&&(b=!1),!a.touches.length)){t.zooming&&(t.moveX=ee(t.moveX,-M.value,M.value),t.moveY=ee(t.moveY,-v.value,v.value),t.zooming=!1),t.moving=!1,L=0,U=0,S=1,t.scale<1&&y();const $=+e.maxZoom;t.scale>$&&(t.scale=$)}be(a,b),u(),d.reset()},P=a=>{const{naturalWidth:b,naturalHeight:$}=a.target;t.imageRatio=$/b};return G(()=>e.active,y),G(()=>e.show,a=>{a||y()}),Ee("touchmove",r,{target:W(()=>{var a;return(a=s.value)==null?void 0:a.$el})}),()=>{const a={loading:()=>p(Je,{type:"spinner"},null)};return p(zt,{ref:s,class:Ie("swipe-item"),onTouchstartPassive:_,onTouchend:z,onTouchcancel:z},{default:()=>[w.image?p("div",{class:Ie("image-wrap")},[w.image({src:e.src})]):p(et,{src:e.src,fit:"contain",class:Ie("image",{vertical:T.value}),style:O.value,onLoad:P},a)]})}}});const[Ht,se]=ce("image-preview"),Wt=["show","teleport","transition","overlayStyle","closeOnPopstate"],Zt={show:Boolean,loop:j,images:He(),minZoom:K(1/3),maxZoom:K(3),overlay:j,closeable:Boolean,showIndex:j,className:Ae,closeIcon:te("clear"),transition:String,beforeClose:Function,overlayClass:Ae,overlayStyle:Object,swipeDuration:K(300),startPosition:K(0),showIndicators:Boolean,closeOnPopstate:j,closeIconPosition:te("top-right"),teleport:[String,Object]};var tt=ne({name:Ht,props:Zt,emits:["scale","close","closed","change","longPress","update:show"],setup(e,{emit:g,slots:w}){const t=V(),d=he({active:0,rootWidth:0,rootHeight:0,disableZoom:!1}),s=()=>{if(t.value){const A=mt(t.value.$el);d.rootWidth=A.width,d.rootHeight=A.height,t.value.resize()}},T=A=>g("scale",A),O=A=>g("update:show",A),M=()=>{We(e.beforeClose,{args:[d.active],done:()=>O(!1)})},v=A=>{A!==d.active&&(d.active=A,g("change",A))},f=()=>{if(e.showIndex)return p("div",{class:se("index")},[w.index?w.index({index:d.active}):`${d.active+1} / ${e.images.length}`])},y=()=>{if(w.cover)return p("div",{class:se("cover")},[w.cover()])},k=()=>{d.disableZoom=!0},R=()=>{d.disableZoom=!1},L=()=>p(Ot,{ref:t,lazyRender:!0,loop:e.loop,class:se("swipe"),duration:e.swipeDuration,initialSwipe:e.startPosition,showIndicators:e.showIndicators,indicatorColor:"white",onChange:v,onDragEnd:R,onDragStart:k},{default:()=>[e.images.map((A,H)=>p(Vt,{src:A,show:e.show,active:d.active,maxZoom:e.maxZoom,minZoom:e.minZoom,rootWidth:d.rootWidth,rootHeight:d.rootHeight,disableZoom:d.disableZoom,onScale:T,onClose:M,onLongPress:()=>g("longPress",{index:H})},{image:w.image}))]}),U=()=>{if(e.closeable)return p(le,{role:"button",name:e.closeIcon,class:[se("close-icon",e.closeIconPosition),ht],onClick:M},null)},S=()=>g("closed"),E=(A,H)=>{var m;return(m=t.value)==null?void 0:m.swipeTo(A,H)};return Ce({swipeTo:E}),ge(s),G([Fe,Ue],s),G(()=>e.startPosition,A=>v(+A)),G(()=>e.show,A=>{const{images:H,startPosition:m}=e;A?(v(+m),me(()=>{s(),E(+m,{immediate:!0})})):g("close",{index:d.active,url:H[d.active]})}),()=>p(Pt,re({class:[se(),e.className],overlayClass:[se("overlay"),e.overlayClass],onClosed:S,"onUpdate:show":O},ve(e,Wt)),{default:()=>[U(),L(),f(),y()]})}});let Se;const jt={loop:!0,images:[],maxZoom:3,minZoom:1/3,onScale:void 0,onClose:void 0,onChange:void 0,teleport:"body",className:"",showIndex:!0,closeable:!1,closeIcon:"clear",transition:void 0,beforeClose:void 0,overlayStyle:void 0,overlayClass:void 0,startPosition:0,swipeDuration:300,showIndicators:!1,closeOnPopstate:!0,closeIconPosition:"top-right"};function Xt(){({instance:Se}=Ge({setup(){const{state:e,toggle:g}=qe(),w=()=>{e.images=[]};return()=>p(tt,re(e,{onClosed:w,"onUpdate:show":g}),null)}}))}const Gt=(e,g=0)=>{if(Oe)return Se||Xt(),e=Array.isArray(e)?{images:e,startPosition:g}:e,Se.open(ue({},jt,e)),Se};we(tt);const[qt,N,Jt]=ce("uploader");function Le(e,g){return new Promise(w=>{if(g==="file"){w();return}const t=new FileReader;t.onload=d=>{w(d.target.result)},g==="dataUrl"?t.readAsDataURL(e):g==="text"&&t.readAsText(e)})}function nt(e,g){return Ze(e).some(w=>w.file?gt(g)?g(w.file):w.file.size>+g:!1)}function Kt(e,g){const w=[],t=[];return e.forEach(d=>{nt(d,g)?t.push(d):w.push(d)}),{valid:w,invalid:t}}const Qt=/\.(jpeg|jpg|gif|png|svg|webp|jfif|bmp|dpg|avif)/i,en=e=>Qt.test(e);function at(e){return e.isImage?!0:e.file&&e.file.type?e.file.type.indexOf("image")===0:e.url?en(e.url):typeof e.content=="string"?e.content.indexOf("data:image")===0:!1}var tn=ne({props:{name:J,item:fe(Object),index:Number,imageFit:String,lazyLoad:Boolean,deletable:Boolean,previewSize:[Number,String,Array],beforeDelete:Function},emits:["delete","preview"],setup(e,{emit:g,slots:w}){const t=()=>{const{status:v,message:f}=e.item;if(v==="uploading"||v==="failed"){const y=v==="failed"?p(le,{name:"close",class:N("mask-icon")},null):p(Je,{class:N("loading")},null),k=Ne(f)&&f!=="";return p("div",{class:N("mask")},[y,k&&p("div",{class:N("mask-message")},[f])])}},d=v=>{const{name:f,item:y,index:k,beforeDelete:R}=e;v.stopPropagation(),We(R,{args:[y,{name:f,index:k}],done:()=>g("delete")})},s=()=>g("preview"),T=()=>{if(e.deletable&&e.item.status!=="uploading"){const v=w["preview-delete"];return p("div",{role:"button",class:N("preview-delete",{shadow:!v}),tabindex:0,"aria-label":Jt("delete"),onClick:d},[v?v():p(le,{name:"cross",class:N("preview-delete-icon")},null)])}},O=()=>{if(w["preview-cover"]){const{index:v,item:f}=e;return p("div",{class:N("preview-cover")},[w["preview-cover"](ue({index:v},f))])}},M=()=>{const{item:v,lazyLoad:f,imageFit:y,previewSize:k}=e;return at(v)?p(et,{fit:y,src:v.content||v.url,class:N("preview-image"),width:Array.isArray(k)?k[0]:k,height:Array.isArray(k)?k[1]:k,lazyLoad:f,onClick:s},{default:O}):p("div",{class:N("file"),style:je(e.previewSize)},[p(le,{class:N("file-icon"),name:"description"},null),p("div",{class:[N("file-name"),"van-ellipsis"]},[v.file?v.file.name:v.url]),O()])};return()=>p("div",{class:N("preview")},[M(),t(),T()])}});const nn={name:K(""),accept:te("image/*"),capture:String,multiple:Boolean,disabled:Boolean,readonly:Boolean,lazyLoad:Boolean,maxCount:K(1/0),imageFit:te("cover"),resultType:te("dataUrl"),uploadIcon:te("photograph"),uploadText:String,deletable:j,afterRead:Function,showUpload:j,modelValue:He(),beforeRead:Function,beforeDelete:Function,previewSize:[Number,String,Array],previewImage:j,previewOptions:Object,previewFullImage:j,maxSize:{type:[Number,String,Function],default:1/0}};var an=ne({name:qt,props:nn,emits:["delete","oversize","clickUpload","closePreview","clickPreview","update:modelValue"],setup(e,{emit:g,slots:w}){const t=V(),d=[],s=(m=e.modelValue.length)=>({name:e.name,index:m}),T=()=>{t.value&&(t.value.value="")},O=m=>{if(T(),nt(m,e.maxSize))if(Array.isArray(m)){const _=Kt(m,e.maxSize);if(m=_.valid,g("oversize",_.invalid,s()),!m.length)return}else{g("oversize",m,s());return}m=he(m),g("update:modelValue",[...e.modelValue,...Ze(m)]),e.afterRead&&e.afterRead(m,s())},M=m=>{const{maxCount:_,modelValue:r,resultType:u}=e;if(Array.isArray(m)){const z=+_-r.length;m.length>z&&(m=m.slice(0,z)),Promise.all(m.map(P=>Le(P,u))).then(P=>{const a=m.map((b,$)=>{const l={file:b,status:"",message:""};return P[$]&&(l.content=P[$]),l});O(a)})}else Le(m,u).then(z=>{const P={file:m,status:"",message:""};z&&(P.content=z),O(P)})},v=m=>{const{files:_}=m.target;if(e.disabled||!_||!_.length)return;const r=_.length===1?_[0]:[].slice.call(_);if(e.beforeRead){const u=e.beforeRead(r,s());if(!u){T();return}if(pt(u)){u.then(z=>{M(z||r)}).catch(T);return}}M(r)};let f;const y=()=>g("closePreview"),k=m=>{if(e.previewFullImage){const _=e.modelValue.filter(at),r=_.map(u=>(u.file&&!u.url&&u.status!=="failed"&&(u.url=URL.createObjectURL(u.file),d.push(u.url)),u.url)).filter(Boolean);f=Gt(ue({images:r,startPosition:_.indexOf(m),onClose:y},e.previewOptions))}},R=()=>{f&&f.close()},L=(m,_)=>{const r=e.modelValue.slice(0);r.splice(_,1),g("update:modelValue",r),g("delete",m,s(_))},U=(m,_)=>{const r=["imageFit","deletable","previewSize","beforeDelete"],u=ue(ve(e,r),ve(m,r,!0));return p(tn,re({item:m,index:_,onClick:()=>g("clickPreview",m,s(_)),onDelete:()=>L(m,_),onPreview:()=>k(m)},ve(e,["name","lazyLoad"]),u),ve(w,["preview-cover","preview-delete"]))},S=()=>{if(e.previewImage)return e.modelValue.map(U)},E=m=>g("clickUpload",m),A=()=>{if(e.modelValue.length>=+e.maxCount)return;const m=e.readonly?null:p("input",{ref:t,type:"file",class:N("input"),accept:e.accept,capture:e.capture,multiple:e.multiple,disabled:e.disabled,onChange:v},null);return w.default?p("div",{class:N("input-wrapper"),onClick:E},[w.default(),m]):Ve(p("div",{class:N("upload",{readonly:e.readonly}),style:je(e.previewSize),onClick:E},[p(le,{name:e.uploadIcon,class:N("upload-icon")},null),e.uploadText&&p("span",{class:N("upload-text")},[e.uploadText]),m]),[[yt,e.showUpload]])},H=()=>{t.value&&!e.disabled&&t.value.click()};return xe(()=>{d.forEach(m=>URL.revokeObjectURL(m))}),Ce({chooseFile:H,closeImagePreview:R}),wt(()=>e.modelValue),()=>p("div",{class:N()},[p("div",{class:N("wrapper",{disabled:e.disabled})},[S(),A()])])}});const on=we(an);var sn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ln(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ot={exports:{}};(function(e,g){(function(w,t){e.exports=t()})(sn,function(){var w=1e3,t=6e4,d=36e5,s="millisecond",T="second",O="minute",M="hour",v="day",f="week",y="month",k="quarter",R="year",L="date",U="Invalid Date",S=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,E=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,A={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(l){var n=["th","st","nd","rd"],o=l%100;return"["+l+(n[(o-20)%10]||n[o]||n[0])+"]"}},H=function(l,n,o){var h=String(l);return!h||h.length>=n?l:""+Array(n+1-h.length).join(o)+l},m={s:H,z:function(l){var n=-l.utcOffset(),o=Math.abs(n),h=Math.floor(o/60),i=o%60;return(n<=0?"+":"-")+H(h,2,"0")+":"+H(i,2,"0")},m:function l(n,o){if(n.date()<o.date())return-l(o,n);var h=12*(o.year()-n.year())+(o.month()-n.month()),i=n.clone().add(h,y),C=o-i<0,x=n.clone().add(h+(C?-1:1),y);return+(-(h+(o-i)/(C?i-x:x-i))||0)},a:function(l){return l<0?Math.ceil(l)||0:Math.floor(l)},p:function(l){return{M:y,y:R,w:f,d:v,D:L,h:M,m:O,s:T,ms:s,Q:k}[l]||String(l||"").toLowerCase().replace(/s$/,"")},u:function(l){return l===void 0}},_="en",r={};r[_]=A;var u=function(l){return l instanceof b},z=function l(n,o,h){var i;if(!n)return _;if(typeof n=="string"){var C=n.toLowerCase();r[C]&&(i=C),o&&(r[C]=o,i=C);var x=n.split("-");if(!i&&x.length>1)return l(x[0])}else{var B=n.name;r[B]=n,i=B}return!h&&i&&(_=i),i||!h&&_},P=function(l,n){if(u(l))return l.clone();var o=typeof n=="object"?n:{};return o.date=l,o.args=arguments,new b(o)},a=m;a.l=z,a.i=u,a.w=function(l,n){return P(l,{locale:n.$L,utc:n.$u,x:n.$x,$offset:n.$offset})};var b=function(){function l(o){this.$L=z(o.locale,null,!0),this.parse(o)}var n=l.prototype;return n.parse=function(o){this.$d=function(h){var i=h.date,C=h.utc;if(i===null)return new Date(NaN);if(a.u(i))return new Date;if(i instanceof Date)return new Date(i);if(typeof i=="string"&&!/Z$/i.test(i)){var x=i.match(S);if(x){var B=x[2]-1||0,c=(x[7]||"0").substring(0,3);return C?new Date(Date.UTC(x[1],B,x[3]||1,x[4]||0,x[5]||0,x[6]||0,c)):new Date(x[1],B,x[3]||1,x[4]||0,x[5]||0,x[6]||0,c)}}return new Date(i)}(o),this.$x=o.x||{},this.init()},n.init=function(){var o=this.$d;this.$y=o.getFullYear(),this.$M=o.getMonth(),this.$D=o.getDate(),this.$W=o.getDay(),this.$H=o.getHours(),this.$m=o.getMinutes(),this.$s=o.getSeconds(),this.$ms=o.getMilliseconds()},n.$utils=function(){return a},n.isValid=function(){return this.$d.toString()!==U},n.isSame=function(o,h){var i=P(o);return this.startOf(h)<=i&&i<=this.endOf(h)},n.isAfter=function(o,h){return P(o)<this.startOf(h)},n.isBefore=function(o,h){return this.endOf(h)<P(o)},n.$g=function(o,h,i){return a.u(o)?this[h]:this.set(i,o)},n.unix=function(){return Math.floor(this.valueOf()/1e3)},n.valueOf=function(){return this.$d.getTime()},n.startOf=function(o,h){var i=this,C=!!a.u(h)||h,x=a.p(o),B=function(ae,Z){var Q=a.w(i.$u?Date.UTC(i.$y,Z,ae):new Date(i.$y,Z,ae),i);return C?Q:Q.endOf(v)},c=function(ae,Z){return a.w(i.toDate()[ae].apply(i.toDate("s"),(C?[0,0,0,0]:[23,59,59,999]).slice(Z)),i)},D=this.$W,I=this.$M,F=this.$D,Y="set"+(this.$u?"UTC":"");switch(x){case R:return C?B(1,0):B(31,11);case y:return C?B(1,I):B(0,I+1);case f:var X=this.$locale().weekStart||0,q=(D<X?D+7:D)-X;return B(C?F-q:F+(6-q),I);case v:case L:return c(Y+"Hours",0);case M:return c(Y+"Minutes",1);case O:return c(Y+"Seconds",2);case T:return c(Y+"Milliseconds",3);default:return this.clone()}},n.endOf=function(o){return this.startOf(o,!1)},n.$set=function(o,h){var i,C=a.p(o),x="set"+(this.$u?"UTC":""),B=(i={},i[v]=x+"Date",i[L]=x+"Date",i[y]=x+"Month",i[R]=x+"FullYear",i[M]=x+"Hours",i[O]=x+"Minutes",i[T]=x+"Seconds",i[s]=x+"Milliseconds",i)[C],c=C===v?this.$D+(h-this.$W):h;if(C===y||C===R){var D=this.clone().set(L,1);D.$d[B](c),D.init(),this.$d=D.set(L,Math.min(this.$D,D.daysInMonth())).$d}else B&&this.$d[B](c);return this.init(),this},n.set=function(o,h){return this.clone().$set(o,h)},n.get=function(o){return this[a.p(o)]()},n.add=function(o,h){var i,C=this;o=Number(o);var x=a.p(h),B=function(I){var F=P(C);return a.w(F.date(F.date()+Math.round(I*o)),C)};if(x===y)return this.set(y,this.$M+o);if(x===R)return this.set(R,this.$y+o);if(x===v)return B(1);if(x===f)return B(7);var c=(i={},i[O]=t,i[M]=d,i[T]=w,i)[x]||1,D=this.$d.getTime()+o*c;return a.w(D,this)},n.subtract=function(o,h){return this.add(-1*o,h)},n.format=function(o){var h=this,i=this.$locale();if(!this.isValid())return i.invalidDate||U;var C=o||"YYYY-MM-DDTHH:mm:ssZ",x=a.z(this),B=this.$H,c=this.$m,D=this.$M,I=i.weekdays,F=i.months,Y=function(Z,Q,De,ye){return Z&&(Z[Q]||Z(h,C))||De[Q].slice(0,ye)},X=function(Z){return a.s(B%12||12,Z,"0")},q=i.meridiem||function(Z,Q,De){var ye=Z<12?"AM":"PM";return De?ye.toLowerCase():ye},ae={YY:String(this.$y).slice(-2),YYYY:this.$y,M:D+1,MM:a.s(D+1,2,"0"),MMM:Y(i.monthsShort,D,F,3),MMMM:Y(F,D),D:this.$D,DD:a.s(this.$D,2,"0"),d:String(this.$W),dd:Y(i.weekdaysMin,this.$W,I,2),ddd:Y(i.weekdaysShort,this.$W,I,3),dddd:I[this.$W],H:String(B),HH:a.s(B,2,"0"),h:X(1),hh:X(2),a:q(B,c,!0),A:q(B,c,!1),m:String(c),mm:a.s(c,2,"0"),s:String(this.$s),ss:a.s(this.$s,2,"0"),SSS:a.s(this.$ms,3,"0"),Z:x};return C.replace(E,function(Z,Q){return Q||ae[Z]||x.replace(":","")})},n.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},n.diff=function(o,h,i){var C,x=a.p(h),B=P(o),c=(B.utcOffset()-this.utcOffset())*t,D=this-B,I=a.m(this,B);return I=(C={},C[R]=I/12,C[y]=I,C[k]=I/3,C[f]=(D-c)/6048e5,C[v]=(D-c)/864e5,C[M]=D/d,C[O]=D/t,C[T]=D/w,C)[x]||D,i?I:a.a(I)},n.daysInMonth=function(){return this.endOf(y).$D},n.$locale=function(){return r[this.$L]},n.locale=function(o,h){if(!o)return this.$L;var i=this.clone(),C=z(o,h,!0);return C&&(i.$L=C),i},n.clone=function(){return a.w(this.$d,this)},n.toDate=function(){return new Date(this.valueOf())},n.toJSON=function(){return this.isValid()?this.toISOString():null},n.toISOString=function(){return this.$d.toISOString()},n.toString=function(){return this.$d.toUTCString()},l}(),$=b.prototype;return P.prototype=$,[["$ms",s],["$s",T],["$m",O],["$H",M],["$W",v],["$M",y],["$y",R],["$D",L]].forEach(function(l){$[l[1]]=function(n){return this.$g(n,l[0],l[1])}}),P.extend=function(l,n){return l.$i||(l(n,b,P),l.$i=!0),P},P.locale=z,P.isDayjs=u,P.unix=function(l){return P(1e3*l)},P.en=r[_],P.Ls=r,P.p={},P})})(ot);var rn=ot.exports;const Ye=ln(rn);const un={class:"home text-center"},cn={class:"upload-box"},dn={key:0,class:"audio-resouse"},fn=["src"],vn={class:"audition"},mn=["src"],hn={__name:"AudioView",setup(e){const g=V(""),w=V(null),t=V(""),d=V(""),s=V([]),T=V(""),O=V(null),M=V(null),v=new(window.AudioContext||window.webkitAudioContext),f=V(null);V(null);const y=V(null);ge(()=>{k()});const k=()=>{g.value=Ye().format("YYYY-MM-DD HH:mm:ss"),w.value=setInterval(()=>{g.value=Ye().format("YYYY-MM-DD HH:mm:ss")},1e3)},R=()=>{if(!y.value){de("片段不能为空");return}Nt({title:"下载提示：浏览器打开进行下载",message:`
        <a href="${T.value}" id="linkText" target="_blank">https://myd-website.github.io/audio/</a>
        <input
          style="width: 100%;"
          class="customFileName"
          value="${y.value}"
          type="text"
          colon
          placeholder="请输入文件名称"
        />`,allowHtml:!0,theme:"round-button"}).then(()=>{const r=document.getElementsByClassName("customFileName")[0].value;if(r)y.value=r.includes("mp3")?r:`${r}.mp3`,L(),U();else{de("文件名称不能为空");return}})},L=async()=>{const r=document.createRange();r.selectNode(document.querySelector("#linkText"));const u=window.getSelection();u.rangeCount>0&&u.removeAllRanges(),u.addRange(r),document.execCommand("Copy"),de("复制成功")},U=r=>{const u=document.createElement("a");u.href=T.value,u.download=y.value,u.click()},S=r=>(console.log(r,"file上传中"),r.status="uploading",r.message="上传中...",!0),E=r=>{console.log(r,"file上传成功"),d.value=r.file.name,t.value=URL.createObjectURL(r.file),H(r.file)},A=r=>{console.log(r,"file上传成功"),d.value="",t.value="",s.value=[]},H=r=>{if(!r)return;const u=new FileReader;u.onload=async()=>{const z=u.result;f.value=await v.decodeAudioData(z)},u.readAsArrayBuffer(r)},m=async(r,u)=>{const z=s.value[0];if(!z.file){de("请先选择一个音频文件");return}if(Number(r)>=Number(u)){de("请输入有效的时间段");return}const P=new(window.AudioContext||window.webkitAudioContext),a=await z.file.arrayBuffer(),b=await P.decodeAudioData(a),$=P.createBuffer(b.numberOfChannels,(u-r)*b.sampleRate,b.sampleRate);for(let n=0;n<b.numberOfChannels;n++){const o=b.getChannelData(n);$.getChannelData(n).set(o.subarray(r*b.sampleRate,u*b.sampleRate))}const l=await _($);T.value=URL.createObjectURL(l),y.value=`[${r}秒~${u}秒片段]_${d.value}`};function _(r){let u=r.numberOfChannels,z=r.length*u*2+44,P=0,a=new DataView(new ArrayBuffer(z)),b=[],$,l,n=0;for(h(1179011410),h(z-8),h(1163280727),h(544501094),h(16),o(1),o(u),h(r.sampleRate),h(r.sampleRate*2*u),o(u*2),o(16),h(1635017060),h(z-n-4),$=0;$<r.numberOfChannels;$++)b.push(r.getChannelData($));for(;n<z;){for($=0;$<u;$++)l=Math.max(-1,Math.min(1,b[$][P])),l=(.5+l<0?l*32768:l*32767)|0,a.setInt16(n,l,!0),n+=2;P++}return new Blob([a],{type:"audio/mp3"});function o(i){a.setUint16(n,i,!0),n+=2}function h(i){a.setUint32(n,i,!0),n+=4}}return xe(()=>{clearInterval(w)}),(r,u)=>{const z=_t,P=on,a=Ct,b=xt,$=Mt;return Re(),ze("div",un,[p(z,{"left-icon":"volume-o",text:`当前时间：${g.value}`},null,8,["text"]),oe("div",cn,[u[4]||(u[4]=oe("p",{class:"mg10"},"请上传音频文件：",-1)),p(P,{modelValue:s.value,"onUpdate:modelValue":u[0]||(u[0]=l=>s.value=l),"max-count":1,"before-read":S,"after-read":E,"before-delete":A,accept:"audio/mp3"},null,8,["modelValue"])]),t.value?(Re(),ze("div",dn,[oe("span",null,bt(d.value),1),oe("audio",{src:t.value,controls:"",autoplay:!1},null,8,fn),p(b,{inset:""},{default:Pe(()=>[p(a,{modelValue:O.value,"onUpdate:modelValue":u[1]||(u[1]=l=>O.value=l),type:"number",colon:"",placeholder:"请输入开始时间",label:"开始时间/秒"},null,8,["modelValue"]),p(a,{modelValue:M.value,"onUpdate:modelValue":u[2]||(u[2]=l=>M.value=l),type:"number",colon:"",placeholder:"请输入结束时间",label:"结束时间/秒"},null,8,["modelValue"])]),_:1}),p($,{type:"success",onClick:u[3]||(u[3]=l=>m(O.value,M.value))},{default:Pe(()=>u[5]||(u[5]=[Me("截取片段")])),_:1}),oe("p",vn,[u[6]||(u[6]=Me(" 试听： ")),oe("audio",{src:T.value,controls:"",autoplay:"false"},null,8,mn)]),p($,{type:"success",onClick:R},{default:Pe(()=>u[7]||(u[7]=[Me("下载")])),_:1})])):St("",!0)])}}},_n=$t(hn,[["__scopeId","data-v-9a628897"]]);export{_n as default};
