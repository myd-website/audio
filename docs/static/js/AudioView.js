import{c as ve,d as de,r as Y,g as Je,a as ee,b as ge,i as Re,w as oe,e as xe,o as Ce,f as Me,n as Se,h as m,j as G,t as E,m as X,k as ze,l as qe,p as ie,I as ae,q as Ie,s as J,u as ce,v as Pe,x as Ke,y as we,z as le,L as Qe,A as Ue,B as ne,C as Oe,D as et,E as tt,F as ue,G as nt,H as ot,J as Ye,K as Fe,M as at,N as Ne,O as it,P as st,Q as rt,_ as lt,R as ke,S as te,T as ct,U as ye,V as pe,W as ut,X as Ae,Y as dt,Z as ft}from"./index.js";import{C as mt}from"./index3.js";import"./index4.js";import{F as vt}from"./index5.js";import{s as ht,S as gt,a as wt}from"./index6.js";import{N as yt}from"./index7.js";import{m as Ve,u as He,a as pt,P as $t,s as $e}from"./function-call.js";import{u as Ee}from"./use-expose.js";import{L as Ze}from"./index8.js";import{B as bt}from"./index9.js";const[St,K]=ve("image"),_t={src:String,alt:String,fit:String,position:String,round:Boolean,block:Boolean,width:G,height:G,radius:G,lazyLoad:Boolean,iconSize:G,showError:E,errorIcon:X("photo-fail"),iconPrefix:String,showLoading:E,loadingIcon:X("photo")};var Dt=de({name:St,props:_t,emits:["load","error"],setup(e,{emit:d,slots:v}){const o=Y(!1),u=Y(!0),D=Y(),{$Lazyload:I}=Je().proxy,O=ee(()=>{const b={width:ge(e.width),height:ge(e.height)};return Re(e.radius)&&(b.overflow="hidden",b.borderRadius=ge(e.radius)),b});oe(()=>e.src,()=>{o.value=!1,u.value=!0});const x=b=>{u.value&&(u.value=!1,d("load",b))},h=()=>{const b=new Event("load");Object.defineProperty(b,"target",{value:D.value,enumerable:!0}),x(b)},M=b=>{o.value=!0,u.value=!1,d("error",b)},C=(b,U,_)=>_?_():m(ae,{name:b,size:e.iconSize,class:U,classPrefix:e.iconPrefix},null),L=()=>{if(u.value&&e.showLoading)return m("div",{class:K("loading")},[C(e.loadingIcon,K("loading-icon"),v.loading)]);if(o.value&&e.showError)return m("div",{class:K("error")},[C(e.errorIcon,K("error-icon"),v.error)])},k=()=>{if(o.value||!e.src)return;const b={alt:e.alt,class:K("img"),style:{objectFit:e.fit,objectPosition:e.position}};return e.lazyLoad?ze(m("img",ie({ref:D},b),null),[[qe("lazy"),e.src]]):m("img",ie({ref:D,src:e.src,onLoad:x,onError:M},b),null)},T=({el:b})=>{const U=()=>{b===D.value&&u.value&&h()};D.value?U():Se(U)},F=({el:b})=>{b===D.value&&!o.value&&M()};return I&&xe&&(I.$on("loaded",T),I.$on("error",F),Ce(()=>{I.$off("loaded",T),I.$off("error",F)})),Me(()=>{Se(()=>{var b;(b=D.value)!=null&&b.complete&&!e.lazyLoad&&h()})}),()=>{var b;return m("div",{class:K({round:e.round,block:e.block}),style:O.value},[k(),L(),(b=v.default)==null?void 0:b.call(v)])}}});const We=Ie(Dt);let _e;const xt={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1};let Ct=J({},xt);function Mt(){({instance:_e}=Ve({setup(){const{state:d,toggle:v}=He();return()=>m(ht,ie(d,{"onUpdate:show":v}),null)}}))}function It(e){return xe?new Promise((d,v)=>{_e||Mt(),_e.open(J({},Ct,e,{callback:o=>{(o==="confirm"?d:v)(o)}}))}):Promise.resolve()}const Pt=e=>It(J({showCancelButton:!0},e)),Le=e=>Math.sqrt((e[0].clientX-e[1].clientX)**2+(e[0].clientY-e[1].clientY)**2),be=ve("image-preview")[1];var Ot=de({props:{src:String,show:Boolean,active:Number,minZoom:ce(G),maxZoom:ce(G),rootWidth:ce(Number),rootHeight:ce(Number),disableZoom:Boolean},emits:["scale","close","longPress"],setup(e,{emit:d,slots:v}){const o=Pe({scale:1,moveX:0,moveY:0,moving:!1,zooming:!1,imageRatio:0,displayWidth:0,displayHeight:0}),u=pt(),D=Y(),I=ee(()=>{const{rootWidth:n,rootHeight:g}=e,w=g/n;return o.imageRatio>w}),O=ee(()=>{const{scale:n,moveX:g,moveY:w,moving:i,zooming:a}=o,t={transitionDuration:a||i?"0s":".3s"};if(n!==1){const f=g/n,s=w/n;t.transform=`scale(${n}, ${n}) translate(${f}px, ${s}px)`}return t}),x=ee(()=>{if(o.imageRatio){const{rootWidth:n,rootHeight:g}=e,w=I.value?g/o.imageRatio:n;return Math.max(0,(o.scale*w-n)/2)}return 0}),h=ee(()=>{if(o.imageRatio){const{rootWidth:n,rootHeight:g}=e,w=I.value?g:n*o.imageRatio;return Math.max(0,(o.scale*w-g)/2)}return 0}),M=n=>{n=le(n,+e.minZoom,+e.maxZoom+1),n!==o.scale&&(o.scale=n,d("scale",{scale:n,index:e.active}))},C=()=>{M(1),o.moveX=0,o.moveY=0},L=()=>{const n=o.scale>1?1:2;M(n),o.moveX=0,o.moveY=0};let k,T,F,b,U,_,N,l=!1;const r=n=>{const{touches:g}=n;if(k=g.length,k===2&&e.disableZoom)return;const{offsetX:w}=u;u.start(n),T=o.moveX,F=o.moveY,N=Date.now(),l=!1,o.moving=k===1&&o.scale!==1,o.zooming=k===2&&!w.value,o.zooming&&(b=o.scale,U=Le(n.touches))},c=n=>{const{touches:g}=n;if(u.move(n),o.moving){const{deltaX:w,deltaY:i}=u,a=w.value+T,t=i.value+F;if((a>x.value||a<-x.value)&&!l&&u.isHorizontal()){o.moving=!1;return}l=!0,we(n,!0),o.moveX=le(a,-x.value,x.value),o.moveY=le(t,-h.value,h.value)}if(o.zooming&&(we(n,!0),g.length===2)){const w=Le(g),i=b*w/U;M(i)}},S=()=>{if(k>1)return;const{offsetX:n,offsetY:g}=u,w=Date.now()-N,i=250,a=5;n.value<a&&g.value<a&&(w<i?_?(clearTimeout(_),_=null,L()):_=setTimeout(()=>{d("close"),_=null},i):w>Qe&&d("longPress"))},A=n=>{let g=!1;if((o.moving||o.zooming)&&(g=!0,o.moving&&T===o.moveX&&F===o.moveY&&(g=!1),!n.touches.length)){o.zooming&&(o.moveX=le(o.moveX,-x.value,x.value),o.moveY=le(o.moveY,-h.value,h.value),o.zooming=!1),o.moving=!1,T=0,F=0,b=1,o.scale<1&&C();const w=+e.maxZoom;o.scale>w&&(o.scale=w)}we(n,g),S(),u.reset()},$=n=>{const{naturalWidth:g,naturalHeight:w}=n.target;o.imageRatio=w/g};return oe(()=>e.active,C),oe(()=>e.show,n=>{n||C()}),Ke("touchmove",c,{target:ee(()=>{var n;return(n=D.value)==null?void 0:n.$el})}),()=>{const n={loading:()=>m(Ze,{type:"spinner"},null)};return m(gt,{ref:D,class:be("swipe-item"),onTouchstartPassive:r,onTouchend:A,onTouchcancel:A},{default:()=>[v.image?m("div",{class:be("image-wrap")},[v.image({src:e.src})]):m(We,{src:e.src,fit:"contain",class:be("image",{vertical:I.value}),style:O.value,onLoad:$},n)]})}}});const[kt,Q]=ve("image-preview"),At=["show","teleport","transition","overlayStyle","closeOnPopstate"],Lt={show:Boolean,loop:E,images:Ue(),minZoom:ne(1/3),maxZoom:ne(3),overlay:E,closeable:Boolean,showIndex:E,className:Oe,closeIcon:X("clear"),transition:String,beforeClose:Function,overlayClass:Oe,overlayStyle:Object,swipeDuration:ne(300),startPosition:ne(0),showIndicators:Boolean,closeOnPopstate:E,closeIconPosition:X("top-right"),teleport:[String,Object]};var je=de({name:kt,props:Lt,emits:["scale","close","closed","change","longPress","update:show"],setup(e,{emit:d,slots:v}){const o=Y(),u=Pe({active:0,rootWidth:0,rootHeight:0,disableZoom:!1}),D=()=>{if(o.value){const _=nt(o.value.$el);u.rootWidth=_.width,u.rootHeight=_.height,o.value.resize()}},I=_=>d("scale",_),O=_=>d("update:show",_),x=()=>{Ye(e.beforeClose,{args:[u.active],done:()=>O(!1)})},h=_=>{_!==u.active&&(u.active=_,d("change",_))},M=()=>{if(e.showIndex)return m("div",{class:Q("index")},[v.index?v.index({index:u.active}):`${u.active+1} / ${e.images.length}`])},C=()=>{if(v.cover)return m("div",{class:Q("cover")},[v.cover()])},L=()=>{u.disableZoom=!0},k=()=>{u.disableZoom=!1},T=()=>m(wt,{ref:o,lazyRender:!0,loop:e.loop,class:Q("swipe"),duration:e.swipeDuration,initialSwipe:e.startPosition,showIndicators:e.showIndicators,indicatorColor:"white",onChange:h,onDragEnd:k,onDragStart:L},{default:()=>[e.images.map((_,N)=>m(Ot,{src:_,show:e.show,active:u.active,maxZoom:e.maxZoom,minZoom:e.minZoom,rootWidth:u.rootWidth,rootHeight:u.rootHeight,disableZoom:u.disableZoom,onScale:I,onClose:x,onLongPress:()=>d("longPress",{index:N})},{image:v.image}))]}),F=()=>{if(e.closeable)return m(ae,{role:"button",name:e.closeIcon,class:[Q("close-icon",e.closeIconPosition),ot],onClick:x},null)},b=()=>d("closed"),U=(_,N)=>{var l;return(l=o.value)==null?void 0:l.swipeTo(_,N)};return Ee({swipeTo:U}),Me(D),oe([et,tt],D),oe(()=>e.startPosition,_=>h(+_)),oe(()=>e.show,_=>{const{images:N,startPosition:l}=e;_?(h(+l),Se(()=>{D(),U(+l,{immediate:!0})})):d("close",{index:u.active,url:N[u.active]})}),()=>m($t,ie({class:[Q(),e.className],overlayClass:[Q("overlay"),e.overlayClass],onClosed:b,"onUpdate:show":O},ue(e,At)),{default:()=>[F(),T(),M(),C()]})}});let me;const Bt={loop:!0,images:[],maxZoom:3,minZoom:1/3,onScale:void 0,onClose:void 0,onChange:void 0,teleport:"body",className:"",showIndex:!0,closeable:!1,closeIcon:"clear",transition:void 0,beforeClose:void 0,overlayStyle:void 0,overlayClass:void 0,startPosition:0,swipeDuration:300,showIndicators:!1,closeOnPopstate:!0,closeIconPosition:"top-right"};function Tt(){({instance:me}=Ve({setup(){const{state:e,toggle:d}=He(),v=()=>{e.images=[]};return()=>m(je,ie(e,{onClosed:v,"onUpdate:show":d}),null)}}))}const Rt=(e,d=0)=>{if(xe)return me||Tt(),e=Array.isArray(e)?{images:e,startPosition:d}:e,me.open(J({},Bt,e)),me};Ie(je);const[zt,z,Ut]=ve("uploader");function Be(e,d){return new Promise(v=>{if(d==="file"){v();return}const o=new FileReader;o.onload=u=>{v(u.target.result)},d==="dataUrl"?o.readAsDataURL(e):d==="text"&&o.readAsText(e)})}function Xe(e,d){return Fe(e).some(v=>v.file?at(d)?d(v.file):v.file.size>+d:!1)}function Yt(e,d){const v=[],o=[];return e.forEach(u=>{Xe(u,d)?o.push(u):v.push(u)}),{valid:v,invalid:o}}const Ft=/\.(jpeg|jpg|gif|png|svg|webp|jfif|bmp|dpg|avif)/i,Nt=e=>Ft.test(e);function Ge(e){return e.isImage?!0:e.file&&e.file.type?e.file.type.indexOf("image")===0:e.url?Nt(e.url):typeof e.content=="string"?e.content.indexOf("data:image")===0:!1}var Vt=de({props:{name:G,item:ce(Object),index:Number,imageFit:String,lazyLoad:Boolean,deletable:Boolean,previewSize:[Number,String,Array],beforeDelete:Function},emits:["delete","preview"],setup(e,{emit:d,slots:v}){const o=()=>{const{status:h,message:M}=e.item;if(h==="uploading"||h==="failed"){const C=h==="failed"?m(ae,{name:"close",class:z("mask-icon")},null):m(Ze,{class:z("loading")},null),L=Re(M)&&M!=="";return m("div",{class:z("mask")},[C,L&&m("div",{class:z("mask-message")},[M])])}},u=h=>{const{name:M,item:C,index:L,beforeDelete:k}=e;h.stopPropagation(),Ye(k,{args:[C,{name:M,index:L}],done:()=>d("delete")})},D=()=>d("preview"),I=()=>{if(e.deletable&&e.item.status!=="uploading"){const h=v["preview-delete"];return m("div",{role:"button",class:z("preview-delete",{shadow:!h}),tabindex:0,"aria-label":Ut("delete"),onClick:u},[h?h():m(ae,{name:"cross",class:z("preview-delete-icon")},null)])}},O=()=>{if(v["preview-cover"]){const{index:h,item:M}=e;return m("div",{class:z("preview-cover")},[v["preview-cover"](J({index:h},M))])}},x=()=>{const{item:h,lazyLoad:M,imageFit:C,previewSize:L}=e;return Ge(h)?m(We,{fit:C,src:h.content||h.url,class:z("preview-image"),width:Array.isArray(L)?L[0]:L,height:Array.isArray(L)?L[1]:L,lazyLoad:M,onClick:D},{default:O}):m("div",{class:z("file"),style:Ne(e.previewSize)},[m(ae,{class:z("file-icon"),name:"description"},null),m("div",{class:[z("file-name"),"van-ellipsis"]},[h.file?h.file.name:h.url]),O()])};return()=>m("div",{class:z("preview")},[x(),o(),I()])}});const Ht={name:ne(""),accept:X("image/*"),capture:String,multiple:Boolean,disabled:Boolean,readonly:Boolean,lazyLoad:Boolean,maxCount:ne(1/0),imageFit:X("cover"),resultType:X("dataUrl"),uploadIcon:X("photograph"),uploadText:String,deletable:E,afterRead:Function,showUpload:E,modelValue:Ue(),beforeRead:Function,beforeDelete:Function,previewSize:[Number,String,Array],previewImage:E,previewOptions:Object,previewFullImage:E,maxSize:{type:[Number,String,Function],default:1/0}};var Et=de({name:zt,props:Ht,emits:["delete","oversize","clickUpload","closePreview","clickPreview","update:modelValue"],setup(e,{emit:d,slots:v}){const o=Y(),u=[],D=(l=e.modelValue.length)=>({name:e.name,index:l}),I=()=>{o.value&&(o.value.value="")},O=l=>{if(I(),Xe(l,e.maxSize))if(Array.isArray(l)){const r=Yt(l,e.maxSize);if(l=r.valid,d("oversize",r.invalid,D()),!l.length)return}else{d("oversize",l,D());return}l=Pe(l),d("update:modelValue",[...e.modelValue,...Fe(l)]),e.afterRead&&e.afterRead(l,D())},x=l=>{const{maxCount:r,modelValue:c,resultType:S}=e;if(Array.isArray(l)){const A=+r-c.length;l.length>A&&(l=l.slice(0,A)),Promise.all(l.map($=>Be($,S))).then($=>{const n=l.map((g,w)=>{const i={file:g,status:"",message:""};return $[w]&&(i.content=$[w]),i});O(n)})}else Be(l,S).then(A=>{const $={file:l,status:"",message:""};A&&($.content=A),O($)})},h=l=>{const{files:r}=l.target;if(e.disabled||!r||!r.length)return;const c=r.length===1?r[0]:[].slice.call(r);if(e.beforeRead){const S=e.beforeRead(c,D());if(!S){I();return}if(rt(S)){S.then(A=>{x(A||c)}).catch(I);return}}x(c)};let M;const C=()=>d("closePreview"),L=l=>{if(e.previewFullImage){const r=e.modelValue.filter(Ge),c=r.map(S=>(S.file&&!S.url&&S.status!=="failed"&&(S.url=URL.createObjectURL(S.file),u.push(S.url)),S.url)).filter(Boolean);M=Rt(J({images:c,startPosition:r.indexOf(l),onClose:C},e.previewOptions))}},k=()=>{M&&M.close()},T=(l,r)=>{const c=e.modelValue.slice(0);c.splice(r,1),d("update:modelValue",c),d("delete",l,D(r))},F=(l,r)=>{const c=["imageFit","deletable","previewSize","beforeDelete"],S=J(ue(e,c),ue(l,c,!0));return m(Vt,ie({item:l,index:r,onClick:()=>d("clickPreview",l,D(r)),onDelete:()=>T(l,r),onPreview:()=>L(l)},ue(e,["name","lazyLoad"]),S),ue(v,["preview-cover","preview-delete"]))},b=()=>{if(e.previewImage)return e.modelValue.map(F)},U=l=>d("clickUpload",l),_=()=>{if(e.modelValue.length>=+e.maxCount)return;const l=e.readonly?null:m("input",{ref:o,type:"file",class:z("input"),accept:e.accept,capture:e.capture,multiple:e.multiple,disabled:e.disabled,onChange:h},null);return v.default?m("div",{class:z("input-wrapper"),onClick:U},[v.default(),l]):ze(m("div",{class:z("upload",{readonly:e.readonly}),style:Ne(e.previewSize),onClick:U},[m(ae,{name:e.uploadIcon,class:z("upload-icon")},null),e.uploadText&&m("span",{class:z("upload-text")},[e.uploadText]),l]),[[st,e.showUpload]])},N=()=>{o.value&&!e.disabled&&o.value.click()};return Ce(()=>{u.forEach(l=>URL.revokeObjectURL(l))}),Ee({chooseFile:N,closeImagePreview:k}),it(()=>e.modelValue),()=>m("div",{class:z()},[m("div",{class:z("wrapper",{disabled:e.disabled})},[b(),_()])])}});const Zt=Ie(Et);var Wt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},De={},jt={get exports(){return De},set exports(e){De=e}};(function(e,d){(function(v,o){e.exports=o()})(Wt,function(){var v=1e3,o=6e4,u=36e5,D="millisecond",I="second",O="minute",x="hour",h="day",M="week",C="month",L="quarter",k="year",T="date",F="Invalid Date",b=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,U=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,_={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(i){var a=["th","st","nd","rd"],t=i%100;return"["+i+(a[(t-20)%10]||a[t]||a[0])+"]"}},N=function(i,a,t){var f=String(i);return!f||f.length>=a?i:""+Array(a+1-f.length).join(t)+i},l={s:N,z:function(i){var a=-i.utcOffset(),t=Math.abs(a),f=Math.floor(t/60),s=t%60;return(a<=0?"+":"-")+N(f,2,"0")+":"+N(s,2,"0")},m:function i(a,t){if(a.date()<t.date())return-i(t,a);var f=12*(t.year()-a.year())+(t.month()-a.month()),s=a.clone().add(f,C),p=t-s<0,y=a.clone().add(f+(p?-1:1),C);return+(-(f+(t-s)/(p?s-y:y-s))||0)},a:function(i){return i<0?Math.ceil(i)||0:Math.floor(i)},p:function(i){return{M:C,y:k,w:M,d:h,D:T,h:x,m:O,s:I,ms:D,Q:L}[i]||String(i||"").toLowerCase().replace(/s$/,"")},u:function(i){return i===void 0}},r="en",c={};c[r]=_;var S=function(i){return i instanceof g},A=function i(a,t,f){var s;if(!a)return r;if(typeof a=="string"){var p=a.toLowerCase();c[p]&&(s=p),t&&(c[p]=t,s=p);var y=a.split("-");if(!s&&y.length>1)return i(y[0])}else{var P=a.name;c[P]=a,s=P}return!f&&s&&(r=s),s||!f&&r},$=function(i,a){if(S(i))return i.clone();var t=typeof a=="object"?a:{};return t.date=i,t.args=arguments,new g(t)},n=l;n.l=A,n.i=S,n.w=function(i,a){return $(i,{locale:a.$L,utc:a.$u,x:a.$x,$offset:a.$offset})};var g=function(){function i(t){this.$L=A(t.locale,null,!0),this.parse(t)}var a=i.prototype;return a.parse=function(t){this.$d=function(f){var s=f.date,p=f.utc;if(s===null)return new Date(NaN);if(n.u(s))return new Date;if(s instanceof Date)return new Date(s);if(typeof s=="string"&&!/Z$/i.test(s)){var y=s.match(b);if(y){var P=y[2]-1||0,R=(y[7]||"0").substring(0,3);return p?new Date(Date.UTC(y[1],P,y[3]||1,y[4]||0,y[5]||0,y[6]||0,R)):new Date(y[1],P,y[3]||1,y[4]||0,y[5]||0,y[6]||0,R)}}return new Date(s)}(t),this.$x=t.x||{},this.init()},a.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},a.$utils=function(){return n},a.isValid=function(){return this.$d.toString()!==F},a.isSame=function(t,f){var s=$(t);return this.startOf(f)<=s&&s<=this.endOf(f)},a.isAfter=function(t,f){return $(t)<this.startOf(f)},a.isBefore=function(t,f){return this.endOf(f)<$(t)},a.$g=function(t,f,s){return n.u(t)?this[f]:this.set(s,t)},a.unix=function(){return Math.floor(this.valueOf()/1e3)},a.valueOf=function(){return this.$d.getTime()},a.startOf=function(t,f){var s=this,p=!!n.u(f)||f,y=n.p(t),P=function(q,H){var j=n.w(s.$u?Date.UTC(s.$y,H,q):new Date(s.$y,H,q),s);return p?j:j.endOf(h)},R=function(q,H){return n.w(s.toDate()[q].apply(s.toDate("s"),(p?[0,0,0,0]:[23,59,59,999]).slice(H)),s)},B=this.$W,V=this.$M,W=this.$D,Z="set"+(this.$u?"UTC":"");switch(y){case k:return p?P(1,0):P(31,11);case C:return p?P(1,V):P(0,V+1);case M:var se=this.$locale().weekStart||0,re=(B<se?B+7:B)-se;return P(p?W-re:W+(6-re),V);case h:case T:return R(Z+"Hours",0);case x:return R(Z+"Minutes",1);case O:return R(Z+"Seconds",2);case I:return R(Z+"Milliseconds",3);default:return this.clone()}},a.endOf=function(t){return this.startOf(t,!1)},a.$set=function(t,f){var s,p=n.p(t),y="set"+(this.$u?"UTC":""),P=(s={},s[h]=y+"Date",s[T]=y+"Date",s[C]=y+"Month",s[k]=y+"FullYear",s[x]=y+"Hours",s[O]=y+"Minutes",s[I]=y+"Seconds",s[D]=y+"Milliseconds",s)[p],R=p===h?this.$D+(f-this.$W):f;if(p===C||p===k){var B=this.clone().set(T,1);B.$d[P](R),B.init(),this.$d=B.set(T,Math.min(this.$D,B.daysInMonth())).$d}else P&&this.$d[P](R);return this.init(),this},a.set=function(t,f){return this.clone().$set(t,f)},a.get=function(t){return this[n.p(t)]()},a.add=function(t,f){var s,p=this;t=Number(t);var y=n.p(f),P=function(V){var W=$(p);return n.w(W.date(W.date()+Math.round(V*t)),p)};if(y===C)return this.set(C,this.$M+t);if(y===k)return this.set(k,this.$y+t);if(y===h)return P(1);if(y===M)return P(7);var R=(s={},s[O]=o,s[x]=u,s[I]=v,s)[y]||1,B=this.$d.getTime()+t*R;return n.w(B,this)},a.subtract=function(t,f){return this.add(-1*t,f)},a.format=function(t){var f=this,s=this.$locale();if(!this.isValid())return s.invalidDate||F;var p=t||"YYYY-MM-DDTHH:mm:ssZ",y=n.z(this),P=this.$H,R=this.$m,B=this.$M,V=s.weekdays,W=s.months,Z=function(H,j,he,fe){return H&&(H[j]||H(f,p))||he[j].slice(0,fe)},se=function(H){return n.s(P%12||12,H,"0")},re=s.meridiem||function(H,j,he){var fe=H<12?"AM":"PM";return he?fe.toLowerCase():fe},q={YY:String(this.$y).slice(-2),YYYY:this.$y,M:B+1,MM:n.s(B+1,2,"0"),MMM:Z(s.monthsShort,B,W,3),MMMM:Z(W,B),D:this.$D,DD:n.s(this.$D,2,"0"),d:String(this.$W),dd:Z(s.weekdaysMin,this.$W,V,2),ddd:Z(s.weekdaysShort,this.$W,V,3),dddd:V[this.$W],H:String(P),HH:n.s(P,2,"0"),h:se(1),hh:se(2),a:re(P,R,!0),A:re(P,R,!1),m:String(R),mm:n.s(R,2,"0"),s:String(this.$s),ss:n.s(this.$s,2,"0"),SSS:n.s(this.$ms,3,"0"),Z:y};return p.replace(U,function(H,j){return j||q[H]||y.replace(":","")})},a.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},a.diff=function(t,f,s){var p,y=n.p(f),P=$(t),R=(P.utcOffset()-this.utcOffset())*o,B=this-P,V=n.m(this,P);return V=(p={},p[k]=V/12,p[C]=V,p[L]=V/3,p[M]=(B-R)/6048e5,p[h]=(B-R)/864e5,p[x]=B/u,p[O]=B/o,p[I]=B/v,p)[y]||B,s?V:n.a(V)},a.daysInMonth=function(){return this.endOf(C).$D},a.$locale=function(){return c[this.$L]},a.locale=function(t,f){if(!t)return this.$L;var s=this.clone(),p=A(t,f,!0);return p&&(s.$L=p),s},a.clone=function(){return n.w(this.$d,this)},a.toDate=function(){return new Date(this.valueOf())},a.toJSON=function(){return this.isValid()?this.toISOString():null},a.toISOString=function(){return this.$d.toISOString()},a.toString=function(){return this.$d.toUTCString()},i}(),w=g.prototype;return $.prototype=w,[["$ms",D],["$s",I],["$m",O],["$H",x],["$W",h],["$M",C],["$y",k],["$D",T]].forEach(function(i){w[i[1]]=function(a){return this.$g(a,i[0],i[1])}}),$.extend=function(i,a){return i.$i||(i(a,g,$),i.$i=!0),$},$.locale=A,$.isDayjs=S,$.unix=function(i){return $(1e3*i)},$.en=c[r],$.Ls=c,$.p={},$})})(jt);const Te=De;const Xt=e=>(dt("data-v-57d23d86"),e=e(),ft(),e),Gt={class:"home text-center"},Jt={class:"upload-box"},qt=Xt(()=>te("p",{class:"mg10"},"请上传音频文件：",-1)),Kt={key:0,class:"audio-resouse"},Qt=["src"],en={class:"audition"},tn=["src"],nn={__name:"AudioView",setup(e){const d=Y(""),v=Y(null),o=Y(""),u=Y(""),D=Y([]),I=Y(""),O=Y(null),x=Y(null),h=new(window.AudioContext||window.webkitAudioContext),M=Y(null);Y(null);const C=Y(null);Me(()=>{L()});const L=()=>{d.value=Te().format("YYYY-MM-DD HH:mm:ss"),v.value=setInterval(()=>{d.value=Te().format("YYYY-MM-DD HH:mm:ss")},1e3)},k=()=>{Pt({title:"下载提示",message:"确实要下载吗？下载后请前往文件目录查看！！！"}).then(()=>{T()}).catch(()=>{$e("取消下载")})},T=r=>{const c=document.createElement("a");c.href=I.value,c.download=`${O.value}秒-${x.value}秒_${u.value}`,c.click()},F=r=>(console.log(r,"file上传中"),r.status="uploading",r.message="上传中...",!0),b=r=>{console.log(r,"file上传成功"),u.value=r.file.name,o.value=URL.createObjectURL(r.file),_(r.file)},U=r=>{console.log(r,"file上传成功"),u.value="",o.value="",D.value=[]},_=r=>{if(!r)return;const c=new FileReader;c.onload=async()=>{const S=c.result;M.value=await h.decodeAudioData(S)},c.readAsArrayBuffer(r)},N=async(r,c)=>{const S=D.value[0];if(!S.file){$e("请先选择一个音频文件");return}if(isNaN(r)||isNaN(c)||r>=c){$e("请输入有效的时间段");return}const A=new(window.AudioContext||window.webkitAudioContext),$=await S.file.arrayBuffer(),n=await A.decodeAudioData($),g=A.createBuffer(n.numberOfChannels,(c-r)*n.sampleRate,n.sampleRate);for(let i=0;i<n.numberOfChannels;i++){const a=n.getChannelData(i);g.getChannelData(i).set(a.subarray(r*n.sampleRate,c*n.sampleRate))}const w=await l(g);I.value=URL.createObjectURL(w),C.value=`${r.value}秒-${c.value}秒_${u.value}`};function l(r){let c=r.numberOfChannels,S=r.length*c*2+44,A=0,$=new DataView(new ArrayBuffer(S)),n=[],g,w,i=0;for(t(1179011410),t(S-8),t(1163280727),t(544501094),t(16),a(1),a(c),t(r.sampleRate),t(r.sampleRate*2*c),a(c*2),a(16),t(1635017060),t(S-i-4),g=0;g<r.numberOfChannels;g++)n.push(r.getChannelData(g));for(;i<S;){for(g=0;g<c;g++)w=Math.max(-1,Math.min(1,n[g][A])),w=(.5+w<0?w*32768:w*32767)|0,$.setInt16(i,w,!0),i+=2;A++}return new Blob([$],{type:"audio/mp3"});function a(f){$.setUint16(i,f,!0),i+=2}function t(f){$.setUint32(i,f,!0),i+=4}}return Ce(()=>{clearInterval(v)}),(r,c)=>{const S=yt,A=Zt,$=vt,n=mt,g=bt;return Ae(),ke("div",Gt,[m(S,{"left-icon":"volume-o",text:`当前时间：${d.value}`},null,8,["text"]),te("div",Jt,[qt,m(A,{modelValue:D.value,"onUpdate:modelValue":c[0]||(c[0]=w=>D.value=w),"max-count":1,"before-read":F,"after-read":b,"before-delete":U,accept:"audio/mp3"},null,8,["modelValue"])]),o.value?(Ae(),ke("div",Kt,[te("span",null,ct(u.value),1),te("audio",{src:o.value,controls:"",autoplay:!1},null,8,Qt),m(n,{inset:""},{default:ye(()=>[m($,{modelValue:O.value,"onUpdate:modelValue":c[1]||(c[1]=w=>O.value=w),type:"number",colon:"",placeholder:"请输入开始时间",label:"开始时间/秒"},null,8,["modelValue"]),m($,{modelValue:x.value,"onUpdate:modelValue":c[2]||(c[2]=w=>x.value=w),type:"number",colon:"",placeholder:"请输入结束时间",label:"结束时间/秒"},null,8,["modelValue"])]),_:1}),m(g,{type:"success",onClick:c[3]||(c[3]=w=>N(O.value,x.value))},{default:ye(()=>[pe("截取片段")]),_:1}),te("p",en,[pe(" 试听： "),te("audio",{src:I.value,controls:"",autoplay:"false"},null,8,tn)]),m(g,{type:"success",onClick:k},{default:ye(()=>[pe("下载")]),_:1})])):ut("",!0)])}}},vn=lt(nn,[["__scopeId","data-v-57d23d86"]]);export{vn as default};
