import{c as de,t as Z,n as K,m as Q,d as oe,r as L,a as we,u as ut,b as W,w as q,e as Ne,f as He,g as ct,o as fe,h as dt,i as ft,j as vt,k as Ce,l as We,p,q as $e,s as Be,v as ge,x as _e,y as te,z as ye,A as mt,B as ht,C as Me,D as Xe,E as Re,F as ae,G as ze,H as gt,I as ue,J as ne,K as ce,L as me,M as wt,N as Ze,O as Le,P as he,Q as yt,R as pt,S as je,T as Ge,U as $t,V as qe,W as bt,X as _t,Y as St,_ as Je,Z as re,$ as Se,a0 as j,a1 as Ue,a2 as xt,a3 as Oe,a4 as Ct,a5 as Ye,a6 as Te,a7 as Ie}from"./index.js";import{C as Dt}from"./index3.js";import"./index4.js";import{F as Pt}from"./index5.js";import{s as Mt}from"./index6.js";import{N as Tt}from"./index7.js";import{u as De}from"./use-expose.js";import{u as Ke,m as Qe,a as et,P as It,s as ve}from"./function-call.js";import{L as tt}from"./index8.js";import{B as kt}from"./index9.js";const[at,be]=de("swipe"),Ot={loop:Z,width:K,height:K,vertical:Boolean,autoplay:Q(0),duration:Q(500),touchable:Z,lazyRender:Boolean,initialSwipe:Q(0),indicatorColor:String,showIndicators:Z,stopPropagation:Z},nt=Symbol(at);var At=oe({name:at,props:Ot,emits:["change","dragStart","dragEnd"],setup(e,{emit:c,slots:g}){const t=L(),f=L(),i=we({rect:null,width:0,height:0,offset:0,active:0,swiping:!1});let D=!1;const T=Ke(),{children:P,linkChildren:h}=ut(nt),m=W(()=>P.length),y=W(()=>i[e.vertical?"height":"width"]),I=W(()=>e.vertical?T.deltaY.value:T.deltaX.value),R=W(()=>i.rect?(e.vertical?i.rect.height:i.rect.width)-y.value*m.value:0),U=W(()=>y.value?Math.ceil(Math.abs(R.value)/y.value):m.value),Y=W(()=>m.value*y.value),b=W(()=>(i.active+m.value)%m.value),F=W(()=>{const v=e.vertical?"vertical":"horizontal";return T.direction.value===v}),O=W(()=>{const v={transitionDuration:`${i.swiping?0:e.duration}ms`,transform:`translate${e.vertical?"Y":"X"}(${i.offset}px)`};if(y.value){const M=e.vertical?"height":"width",A=e.vertical?"width":"height";v[M]=`${Y.value}px`,v[A]=e[A]?`${e[A]}px`:""}return v}),N=v=>{const{active:M}=i;return v?e.loop?te(M+v,-1,m.value):te(M+v,0,U.value):M},u=(v,M=0)=>{let A=v*y.value;e.loop||(A=Math.min(A,-R.value));let V=M-A;return e.loop||(V=te(V,R.value,0)),V},S=({pace:v=0,offset:M=0,emitChange:A})=>{if(m.value<=1)return;const{active:V}=i,E=N(v),G=u(E,M);if(e.loop){if(P[0]&&G!==R.value){const J=G<R.value;P[0].setOffset(J?Y.value:0)}if(P[m.value-1]&&G!==0){const J=G>0;P[m.value-1].setOffset(J?-Y.value:0)}}i.active=E,i.offset=G,A&&E!==V&&c("change",b.value)},r=()=>{i.swiping=!0,i.active<=-1?S({pace:m.value}):i.active>=m.value&&S({pace:-m.value})},d=()=>{r(),T.reset(),$e(()=>{i.swiping=!1,S({pace:-1,emitChange:!0})})},z=()=>{r(),T.reset(),$e(()=>{i.swiping=!1,S({pace:1,emitChange:!0})})};let k;const a=()=>clearTimeout(k),_=()=>{a(),+e.autoplay>0&&m.value>1&&(k=setTimeout(()=>{z(),_()},+e.autoplay))},$=(v=+e.initialSwipe)=>{if(!t.value)return;const M=()=>{var A,V;if(!Be(t)){const E={width:t.value.offsetWidth,height:t.value.offsetHeight};i.rect=E,i.width=+((A=e.width)!=null?A:E.width),i.height=+((V=e.height)!=null?V:E.height)}m.value&&(v=Math.min(m.value-1,v),v===-1&&(v=m.value-1)),i.active=v,i.swiping=!0,i.offset=u(v),P.forEach(E=>{E.setOffset(0)}),_()};Be(t)?ge().then(M):M()},s=()=>$(i.active);let n;const o=v=>{!e.touchable||v.touches.length>1||(T.start(v),D=!1,n=Date.now(),a(),r())},w=v=>{e.touchable&&i.swiping&&(T.move(v),F.value&&(!e.loop&&(i.active===0&&I.value>0||i.active===m.value-1&&I.value<0)||(_e(v,e.stopPropagation),S({offset:I.value}),D||(c("dragStart",{index:b.value}),D=!0))))},l=()=>{if(!e.touchable||!i.swiping)return;const v=Date.now()-n,M=I.value/v;if((Math.abs(M)>.25||Math.abs(I.value)>y.value/2)&&F.value){const V=e.vertical?T.offsetY.value:T.offsetX.value;let E=0;e.loop?E=V>0?I.value>0?-1:1:0:E=-Math[I.value>0?"ceil":"floor"](I.value/y.value),S({pace:E,emitChange:!0})}else I.value&&S({pace:0});D=!1,i.swiping=!1,c("dragEnd",{index:b.value}),_()},x=(v,M={})=>{r(),T.reset(),$e(()=>{let A;e.loop&&v===m.value?A=i.active===0?0:v:A=v%m.value,M.immediate?$e(()=>{i.swiping=!1}):i.swiping=!1,S({pace:A-i.active,emitChange:!0})})},C=(v,M)=>{const A=M===b.value,V=A?{backgroundColor:e.indicatorColor}:void 0;return p("i",{style:V,class:be("indicator",{active:A})},null)},B=()=>{if(g.indicator)return g.indicator({active:b.value,total:m.value});if(e.showIndicators&&m.value>1)return p("div",{class:be("indicators",{vertical:e.vertical})},[Array(m.value).fill("").map(C)])};return De({prev:d,next:z,state:i,resize:s,swipeTo:x}),h({size:y,props:e,count:m,activeIndicator:b}),q(()=>e.initialSwipe,v=>$(+v)),q(m,()=>$(i.active)),q(()=>e.autoplay,_),q([Ne,He,()=>e.width,()=>e.height],s),q(ct(),v=>{v==="visible"?_():a()}),fe($),dt(()=>$(i.active)),ft(()=>$(i.active)),vt(a),Ce(a),We("touchmove",w,{target:f}),()=>{var v;return p("div",{ref:t,class:be()},[p("div",{ref:f,style:O.value,class:be("track",{vertical:e.vertical}),onTouchstartPassive:o,onTouchend:l,onTouchcancel:l},[(v=g.default)==null?void 0:v.call(g)]),B()])}}});const Rt=ye(At),[zt,Bt]=de("swipe-item");var Lt=oe({name:zt,setup(e,{slots:c}){let g;const t=we({offset:0,inited:!1,mounted:!1}),{parent:f,index:i}=mt(nt);if(!f)return;const D=W(()=>{const h={},{vertical:m}=f.props;return f.size.value&&(h[m?"height":"width"]=`${f.size.value}px`),t.offset&&(h.transform=`translate${m?"Y":"X"}(${t.offset}px)`),h}),T=W(()=>{const{loop:h,lazyRender:m}=f.props;if(!m||g)return!0;if(!t.mounted)return!1;const y=f.activeIndicator.value,I=f.count.value-1,R=y===0&&h?I:y-1,U=y===I&&h?0:y+1;return g=i.value===y||i.value===R||i.value===U,g}),P=h=>{t.offset=h};return fe(()=>{ge(()=>{t.mounted=!0})}),De({setOffset:P}),()=>{var h;return p("div",{class:Bt(),style:D.value},[T.value?(h=c.default)==null?void 0:h.call(c):null])}}});const Ut=ye(Lt),[Yt,le]=de("image"),Et={src:String,alt:String,fit:String,position:String,round:Boolean,block:Boolean,width:K,height:K,radius:K,lazyLoad:Boolean,iconSize:K,showError:Z,errorIcon:ae("photo-fail"),iconPrefix:String,showLoading:Z,loadingIcon:ae("photo")};var Ft=oe({name:Yt,props:Et,emits:["load","error"],setup(e,{emit:c,slots:g}){const t=L(!1),f=L(!0),i=L(),{$Lazyload:D}=ht().proxy,T=W(()=>{const b={width:Me(e.width),height:Me(e.height)};return Xe(e.radius)&&(b.overflow="hidden",b.borderRadius=Me(e.radius)),b});q(()=>e.src,()=>{t.value=!1,f.value=!0});const P=b=>{f.value&&(f.value=!1,c("load",b))},h=()=>{const b=new Event("load");Object.defineProperty(b,"target",{value:i.value,enumerable:!0}),P(b)},m=b=>{t.value=!0,f.value=!1,c("error",b)},y=(b,F,O)=>O?O():p(ne,{name:b,size:e.iconSize,class:F,classPrefix:e.iconPrefix},null),I=()=>{if(f.value&&e.showLoading)return p("div",{class:le("loading")},[y(e.loadingIcon,le("loading-icon"),g.loading)]);if(t.value&&e.showError)return p("div",{class:le("error")},[y(e.errorIcon,le("error-icon"),g.error)])},R=()=>{if(t.value||!e.src)return;const b={alt:e.alt,class:le("img"),style:{objectFit:e.fit,objectPosition:e.position}};return e.lazyLoad?ze(p("img",ue({ref:i},b),null),[[gt("lazy"),e.src]]):p("img",ue({ref:i,src:e.src,onLoad:P,onError:m},b),null)},U=({el:b})=>{const F=()=>{b===i.value&&f.value&&h()};i.value?F():ge(F)},Y=({el:b})=>{b===i.value&&!t.value&&m()};return D&&Re&&(D.$on("loaded",U),D.$on("error",Y),Ce(()=>{D.$off("loaded",U),D.$off("error",Y)})),fe(()=>{ge(()=>{var b;(b=i.value)!=null&&b.complete&&!e.lazyLoad&&h()})}),()=>{var b;return p("div",{class:le({round:e.round,block:e.block}),style:T.value},[R(),I(),(b=g.default)==null?void 0:b.call(g)])}}});const ot=ye(Ft);let Ae;const Vt={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1};let Nt=ce({},Vt);function Ht(){({instance:Ae}=Qe({setup(){const{state:c,toggle:g}=et();return()=>p(Mt,ue(c,{"onUpdate:show":g}),null)}}))}function Wt(e){return Re?new Promise((c,g)=>{Ae||Ht(),Ae.open(ce({},Nt,e,{callback:t=>{(t==="confirm"?c:g)(t)}}))}):Promise.resolve()}const Ee=e=>Math.sqrt((e[0].clientX-e[1].clientX)**2+(e[0].clientY-e[1].clientY)**2),ke=de("image-preview")[1];var Xt=oe({props:{src:String,show:Boolean,active:Number,minZoom:me(K),maxZoom:me(K),rootWidth:me(Number),rootHeight:me(Number),disableZoom:Boolean},emits:["scale","close","longPress"],setup(e,{emit:c,slots:g}){const t=we({scale:1,moveX:0,moveY:0,moving:!1,zooming:!1,imageRatio:0,displayWidth:0,displayHeight:0}),f=Ke(),i=L(),D=W(()=>{const{rootWidth:a,rootHeight:_}=e,$=_/a;return t.imageRatio>$}),T=W(()=>{const{scale:a,moveX:_,moveY:$,moving:s,zooming:n}=t,o={transitionDuration:n||s?"0s":".3s"};if(a!==1){const w=_/a,l=$/a;o.transform=`scale(${a}, ${a}) translate(${w}px, ${l}px)`}return o}),P=W(()=>{if(t.imageRatio){const{rootWidth:a,rootHeight:_}=e,$=D.value?_/t.imageRatio:a;return Math.max(0,(t.scale*$-a)/2)}return 0}),h=W(()=>{if(t.imageRatio){const{rootWidth:a,rootHeight:_}=e,$=D.value?_:a*t.imageRatio;return Math.max(0,(t.scale*$-_)/2)}return 0}),m=a=>{a=te(a,+e.minZoom,+e.maxZoom+1),a!==t.scale&&(t.scale=a,c("scale",{scale:a,index:e.active}))},y=()=>{m(1),t.moveX=0,t.moveY=0},I=()=>{const a=t.scale>1?1:2;m(a),t.moveX=0,t.moveY=0};let R,U,Y,b,F,O,N,u=!1;const S=a=>{const{touches:_}=a;if(R=_.length,R===2&&e.disableZoom)return;const{offsetX:$}=f;f.start(a),U=t.moveX,Y=t.moveY,N=Date.now(),u=!1,t.moving=R===1&&t.scale!==1,t.zooming=R===2&&!$.value,t.zooming&&(b=t.scale,F=Ee(a.touches))},r=a=>{const{touches:_}=a;if(f.move(a),t.moving){const{deltaX:$,deltaY:s}=f,n=$.value+U,o=s.value+Y;if((n>P.value||n<-P.value)&&!u&&f.isHorizontal()){t.moving=!1;return}u=!0,_e(a,!0),t.moveX=te(n,-P.value,P.value),t.moveY=te(o,-h.value,h.value)}if(t.zooming&&(_e(a,!0),_.length===2)){const $=Ee(_),s=b*$/F;m(s)}},d=()=>{if(R>1)return;const{offsetX:a,offsetY:_}=f,$=Date.now()-N,s=250,n=5;a.value<n&&_.value<n&&($<s?O?(clearTimeout(O),O=null,I()):O=setTimeout(()=>{c("close"),O=null},s):$>wt&&c("longPress"))},z=a=>{let _=!1;if((t.moving||t.zooming)&&(_=!0,t.moving&&U===t.moveX&&Y===t.moveY&&(_=!1),!a.touches.length)){t.zooming&&(t.moveX=te(t.moveX,-P.value,P.value),t.moveY=te(t.moveY,-h.value,h.value),t.zooming=!1),t.moving=!1,U=0,Y=0,b=1,t.scale<1&&y();const $=+e.maxZoom;t.scale>$&&(t.scale=$)}_e(a,_),d(),f.reset()},k=a=>{const{naturalWidth:_,naturalHeight:$}=a.target;t.imageRatio=$/_};return q(()=>e.active,y),q(()=>e.show,a=>{a||y()}),We("touchmove",r,{target:W(()=>{var a;return(a=i.value)==null?void 0:a.$el})}),()=>{const a={loading:()=>p(tt,{type:"spinner"},null)};return p(Ut,{ref:i,class:ke("swipe-item"),onTouchstartPassive:S,onTouchend:z,onTouchcancel:z},{default:()=>[g.image?p("div",{class:ke("image-wrap")},[g.image({src:e.src})]):p(ot,{src:e.src,fit:"contain",class:ke("image",{vertical:D.value}),style:T.value,onLoad:k},a)]})}}});const[Zt,se]=de("image-preview"),jt=["show","teleport","transition","overlayStyle","closeOnPopstate"],Gt={show:Boolean,loop:Z,images:Ze(),minZoom:Q(1/3),maxZoom:Q(3),overlay:Z,closeable:Boolean,showIndex:Z,className:Le,closeIcon:ae("clear"),transition:String,beforeClose:Function,overlayClass:Le,overlayStyle:Object,swipeDuration:Q(300),startPosition:Q(0),showIndicators:Boolean,closeOnPopstate:Z,closeIconPosition:ae("top-right"),teleport:[String,Object]};var it=oe({name:Zt,props:Gt,emits:["scale","close","closed","change","longPress","update:show"],setup(e,{emit:c,slots:g}){const t=L(),f=we({active:0,rootWidth:0,rootHeight:0,disableZoom:!1}),i=()=>{if(t.value){const O=yt(t.value.$el);f.rootWidth=O.width,f.rootHeight=O.height,t.value.resize()}},D=O=>c("scale",O),T=O=>c("update:show",O),P=()=>{je(e.beforeClose,{args:[f.active],done:()=>T(!1)})},h=O=>{O!==f.active&&(f.active=O,c("change",O))},m=()=>{if(e.showIndex)return p("div",{class:se("index")},[g.index?g.index({index:f.active}):`${f.active+1} / ${e.images.length}`])},y=()=>{if(g.cover)return p("div",{class:se("cover")},[g.cover()])},I=()=>{f.disableZoom=!0},R=()=>{f.disableZoom=!1},U=()=>p(Rt,{ref:t,lazyRender:!0,loop:e.loop,class:se("swipe"),duration:e.swipeDuration,initialSwipe:e.startPosition,showIndicators:e.showIndicators,indicatorColor:"white",onChange:h,onDragEnd:R,onDragStart:I},{default:()=>[e.images.map((O,N)=>p(Xt,{src:O,show:e.show,active:f.active,maxZoom:e.maxZoom,minZoom:e.minZoom,rootWidth:f.rootWidth,rootHeight:f.rootHeight,disableZoom:f.disableZoom,onScale:D,onClose:P,onLongPress:()=>c("longPress",{index:N})},{image:g.image}))]}),Y=()=>{if(e.closeable)return p(ne,{role:"button",name:e.closeIcon,class:[se("close-icon",e.closeIconPosition),pt],onClick:P},null)},b=()=>c("closed"),F=(O,N)=>{var u;return(u=t.value)==null?void 0:u.swipeTo(O,N)};return De({swipeTo:F}),fe(i),q([Ne,He],i),q(()=>e.startPosition,O=>h(+O)),q(()=>e.show,O=>{const{images:N,startPosition:u}=e;O?(h(+u),ge(()=>{i(),F(+u,{immediate:!0})})):c("close",{index:f.active,url:N[f.active]})}),()=>p(It,ue({class:[se(),e.className],overlayClass:[se("overlay"),e.overlayClass],onClosed:b,"onUpdate:show":T},he(e,jt)),{default:()=>[Y(),U(),m(),y()]})}});let xe;const qt={loop:!0,images:[],maxZoom:3,minZoom:1/3,onScale:void 0,onClose:void 0,onChange:void 0,teleport:"body",className:"",showIndex:!0,closeable:!1,closeIcon:"clear",transition:void 0,beforeClose:void 0,overlayStyle:void 0,overlayClass:void 0,startPosition:0,swipeDuration:300,showIndicators:!1,closeOnPopstate:!0,closeIconPosition:"top-right"};function Jt(){({instance:xe}=Qe({setup(){const{state:e,toggle:c}=et(),g=()=>{e.images=[]};return()=>p(it,ue(e,{onClosed:g,"onUpdate:show":c}),null)}}))}const Kt=(e,c=0)=>{if(Re)return xe||Jt(),e=Array.isArray(e)?{images:e,startPosition:c}:e,xe.open(ce({},qt,e)),xe};ye(it);const[Qt,H,ea]=de("uploader");function Fe(e,c){return new Promise(g=>{if(c==="file"){g();return}const t=new FileReader;t.onload=f=>{g(f.target.result)},c==="dataUrl"?t.readAsDataURL(e):c==="text"&&t.readAsText(e)})}function lt(e,c){return Ge(e).some(g=>g.file?$t(c)?c(g.file):g.file.size>+c:!1)}function ta(e,c){const g=[],t=[];return e.forEach(f=>{lt(f,c)?t.push(f):g.push(f)}),{valid:g,invalid:t}}const aa=/\.(jpeg|jpg|gif|png|svg|webp|jfif|bmp|dpg|avif)/i,na=e=>aa.test(e);function st(e){return e.isImage?!0:e.file&&e.file.type?e.file.type.indexOf("image")===0:e.url?na(e.url):typeof e.content=="string"?e.content.indexOf("data:image")===0:!1}var oa=oe({props:{name:K,item:me(Object),index:Number,imageFit:String,lazyLoad:Boolean,deletable:Boolean,previewSize:[Number,String,Array],beforeDelete:Function},emits:["delete","preview"],setup(e,{emit:c,slots:g}){const t=()=>{const{status:h,message:m}=e.item;if(h==="uploading"||h==="failed"){const y=h==="failed"?p(ne,{name:"close",class:H("mask-icon")},null):p(tt,{class:H("loading")},null),I=Xe(m)&&m!=="";return p("div",{class:H("mask")},[y,I&&p("div",{class:H("mask-message")},[m])])}},f=h=>{const{name:m,item:y,index:I,beforeDelete:R}=e;h.stopPropagation(),je(R,{args:[y,{name:m,index:I}],done:()=>c("delete")})},i=()=>c("preview"),D=()=>{if(e.deletable&&e.item.status!=="uploading"){const h=g["preview-delete"];return p("div",{role:"button",class:H("preview-delete",{shadow:!h}),tabindex:0,"aria-label":ea("delete"),onClick:f},[h?h():p(ne,{name:"cross",class:H("preview-delete-icon")},null)])}},T=()=>{if(g["preview-cover"]){const{index:h,item:m}=e;return p("div",{class:H("preview-cover")},[g["preview-cover"](ce({index:h},m))])}},P=()=>{const{item:h,lazyLoad:m,imageFit:y,previewSize:I}=e;return st(h)?p(ot,{fit:y,src:h.content||h.url,class:H("preview-image"),width:Array.isArray(I)?I[0]:I,height:Array.isArray(I)?I[1]:I,lazyLoad:m,onClick:i},{default:T}):p("div",{class:H("file"),style:qe(e.previewSize)},[p(ne,{class:H("file-icon"),name:"description"},null),p("div",{class:[H("file-name"),"van-ellipsis"]},[h.file?h.file.name:h.url]),T()])};return()=>p("div",{class:H("preview")},[P(),t(),D()])}});const ia={name:Q(""),accept:ae("image/*"),capture:String,multiple:Boolean,disabled:Boolean,readonly:Boolean,lazyLoad:Boolean,maxCount:Q(1/0),imageFit:ae("cover"),resultType:ae("dataUrl"),uploadIcon:ae("photograph"),uploadText:String,deletable:Z,afterRead:Function,showUpload:Z,modelValue:Ze(),beforeRead:Function,beforeDelete:Function,previewSize:[Number,String,Array],previewImage:Z,previewOptions:Object,previewFullImage:Z,maxSize:{type:[Number,String,Function],default:1/0}};var la=oe({name:Qt,props:ia,emits:["delete","oversize","clickUpload","closePreview","clickPreview","update:modelValue"],setup(e,{emit:c,slots:g}){const t=L(),f=[],i=(u=e.modelValue.length)=>({name:e.name,index:u}),D=()=>{t.value&&(t.value.value="")},T=u=>{if(D(),lt(u,e.maxSize))if(Array.isArray(u)){const S=ta(u,e.maxSize);if(u=S.valid,c("oversize",S.invalid,i()),!u.length)return}else{c("oversize",u,i());return}u=we(u),c("update:modelValue",[...e.modelValue,...Ge(u)]),e.afterRead&&e.afterRead(u,i())},P=u=>{const{maxCount:S,modelValue:r,resultType:d}=e;if(Array.isArray(u)){const z=+S-r.length;u.length>z&&(u=u.slice(0,z)),Promise.all(u.map(k=>Fe(k,d))).then(k=>{const a=u.map((_,$)=>{const s={file:_,status:"",message:""};return k[$]&&(s.content=k[$]),s});T(a)})}else Fe(u,d).then(z=>{const k={file:u,status:"",message:""};z&&(k.content=z),T(k)})},h=u=>{const{files:S}=u.target;if(e.disabled||!S||!S.length)return;const r=S.length===1?S[0]:[].slice.call(S);if(e.beforeRead){const d=e.beforeRead(r,i());if(!d){D();return}if(St(d)){d.then(z=>{P(z||r)}).catch(D);return}}P(r)};let m;const y=()=>c("closePreview"),I=u=>{if(e.previewFullImage){const S=e.modelValue.filter(st),r=S.map(d=>(d.file&&!d.url&&d.status!=="failed"&&(d.url=URL.createObjectURL(d.file),f.push(d.url)),d.url)).filter(Boolean);m=Kt(ce({images:r,startPosition:S.indexOf(u),onClose:y},e.previewOptions))}},R=()=>{m&&m.close()},U=(u,S)=>{const r=e.modelValue.slice(0);r.splice(S,1),c("update:modelValue",r),c("delete",u,i(S))},Y=(u,S)=>{const r=["imageFit","deletable","previewSize","beforeDelete"],d=ce(he(e,r),he(u,r,!0));return p(oa,ue({item:u,index:S,onClick:()=>c("clickPreview",u,i(S)),onDelete:()=>U(u,S),onPreview:()=>I(u)},he(e,["name","lazyLoad"]),d),he(g,["preview-cover","preview-delete"]))},b=()=>{if(e.previewImage)return e.modelValue.map(Y)},F=u=>c("clickUpload",u),O=()=>{if(e.modelValue.length>=+e.maxCount)return;const u=e.readonly?null:p("input",{ref:t,type:"file",class:H("input"),accept:e.accept,capture:e.capture,multiple:e.multiple,disabled:e.disabled,onChange:h},null);return g.default?p("div",{class:H("input-wrapper"),onClick:F},[g.default(),u]):ze(p("div",{class:H("upload",{readonly:e.readonly}),style:qe(e.previewSize),onClick:F},[p(ne,{name:e.uploadIcon,class:H("upload-icon")},null),e.uploadText&&p("span",{class:H("upload-text")},[e.uploadText]),u]),[[_t,e.showUpload]])},N=()=>{t.value&&!e.disabled&&t.value.click()};return Ce(()=>{f.forEach(u=>URL.revokeObjectURL(u))}),De({chooseFile:N,closeImagePreview:R}),bt(()=>e.modelValue),()=>p("div",{class:H()},[p("div",{class:H("wrapper",{disabled:e.disabled})},[b(),O()])])}});const sa=ye(la);var ra=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ua(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var rt={exports:{}};(function(e,c){(function(g,t){e.exports=t()})(ra,function(){var g=1e3,t=6e4,f=36e5,i="millisecond",D="second",T="minute",P="hour",h="day",m="week",y="month",I="quarter",R="year",U="date",Y="Invalid Date",b=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,F=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,O={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(s){var n=["th","st","nd","rd"],o=s%100;return"["+s+(n[(o-20)%10]||n[o]||n[0])+"]"}},N=function(s,n,o){var w=String(s);return!w||w.length>=n?s:""+Array(n+1-w.length).join(o)+s},u={s:N,z:function(s){var n=-s.utcOffset(),o=Math.abs(n),w=Math.floor(o/60),l=o%60;return(n<=0?"+":"-")+N(w,2,"0")+":"+N(l,2,"0")},m:function s(n,o){if(n.date()<o.date())return-s(o,n);var w=12*(o.year()-n.year())+(o.month()-n.month()),l=n.clone().add(w,y),x=o-l<0,C=n.clone().add(w+(x?-1:1),y);return+(-(w+(o-l)/(x?l-C:C-l))||0)},a:function(s){return s<0?Math.ceil(s)||0:Math.floor(s)},p:function(s){return{M:y,y:R,w:m,d:h,D:U,h:P,m:T,s:D,ms:i,Q:I}[s]||String(s||"").toLowerCase().replace(/s$/,"")},u:function(s){return s===void 0}},S="en",r={};r[S]=O;var d=function(s){return s instanceof _},z=function s(n,o,w){var l;if(!n)return S;if(typeof n=="string"){var x=n.toLowerCase();r[x]&&(l=x),o&&(r[x]=o,l=x);var C=n.split("-");if(!l&&C.length>1)return s(C[0])}else{var B=n.name;r[B]=n,l=B}return!w&&l&&(S=l),l||!w&&S},k=function(s,n){if(d(s))return s.clone();var o=typeof n=="object"?n:{};return o.date=s,o.args=arguments,new _(o)},a=u;a.l=z,a.i=d,a.w=function(s,n){return k(s,{locale:n.$L,utc:n.$u,x:n.$x,$offset:n.$offset})};var _=function(){function s(o){this.$L=z(o.locale,null,!0),this.parse(o)}var n=s.prototype;return n.parse=function(o){this.$d=function(w){var l=w.date,x=w.utc;if(l===null)return new Date(NaN);if(a.u(l))return new Date;if(l instanceof Date)return new Date(l);if(typeof l=="string"&&!/Z$/i.test(l)){var C=l.match(b);if(C){var B=C[2]-1||0,v=(C[7]||"0").substring(0,3);return x?new Date(Date.UTC(C[1],B,C[3]||1,C[4]||0,C[5]||0,C[6]||0,v)):new Date(C[1],B,C[3]||1,C[4]||0,C[5]||0,C[6]||0,v)}}return new Date(l)}(o),this.$x=o.x||{},this.init()},n.init=function(){var o=this.$d;this.$y=o.getFullYear(),this.$M=o.getMonth(),this.$D=o.getDate(),this.$W=o.getDay(),this.$H=o.getHours(),this.$m=o.getMinutes(),this.$s=o.getSeconds(),this.$ms=o.getMilliseconds()},n.$utils=function(){return a},n.isValid=function(){return this.$d.toString()!==Y},n.isSame=function(o,w){var l=k(o);return this.startOf(w)<=l&&l<=this.endOf(w)},n.isAfter=function(o,w){return k(o)<this.startOf(w)},n.isBefore=function(o,w){return this.endOf(w)<k(o)},n.$g=function(o,w,l){return a.u(o)?this[w]:this.set(l,o)},n.unix=function(){return Math.floor(this.valueOf()/1e3)},n.valueOf=function(){return this.$d.getTime()},n.startOf=function(o,w){var l=this,x=!!a.u(w)||w,C=a.p(o),B=function(ie,X){var ee=a.w(l.$u?Date.UTC(l.$y,X,ie):new Date(l.$y,X,ie),l);return x?ee:ee.endOf(h)},v=function(ie,X){return a.w(l.toDate()[ie].apply(l.toDate("s"),(x?[0,0,0,0]:[23,59,59,999]).slice(X)),l)},M=this.$W,A=this.$M,V=this.$D,E="set"+(this.$u?"UTC":"");switch(C){case R:return x?B(1,0):B(31,11);case y:return x?B(1,A):B(0,A+1);case m:var G=this.$locale().weekStart||0,J=(M<G?M+7:M)-G;return B(x?V-J:V+(6-J),A);case h:case U:return v(E+"Hours",0);case P:return v(E+"Minutes",1);case T:return v(E+"Seconds",2);case D:return v(E+"Milliseconds",3);default:return this.clone()}},n.endOf=function(o){return this.startOf(o,!1)},n.$set=function(o,w){var l,x=a.p(o),C="set"+(this.$u?"UTC":""),B=(l={},l[h]=C+"Date",l[U]=C+"Date",l[y]=C+"Month",l[R]=C+"FullYear",l[P]=C+"Hours",l[T]=C+"Minutes",l[D]=C+"Seconds",l[i]=C+"Milliseconds",l)[x],v=x===h?this.$D+(w-this.$W):w;if(x===y||x===R){var M=this.clone().set(U,1);M.$d[B](v),M.init(),this.$d=M.set(U,Math.min(this.$D,M.daysInMonth())).$d}else B&&this.$d[B](v);return this.init(),this},n.set=function(o,w){return this.clone().$set(o,w)},n.get=function(o){return this[a.p(o)]()},n.add=function(o,w){var l,x=this;o=Number(o);var C=a.p(w),B=function(A){var V=k(x);return a.w(V.date(V.date()+Math.round(A*o)),x)};if(C===y)return this.set(y,this.$M+o);if(C===R)return this.set(R,this.$y+o);if(C===h)return B(1);if(C===m)return B(7);var v=(l={},l[T]=t,l[P]=f,l[D]=g,l)[C]||1,M=this.$d.getTime()+o*v;return a.w(M,this)},n.subtract=function(o,w){return this.add(-1*o,w)},n.format=function(o){var w=this,l=this.$locale();if(!this.isValid())return l.invalidDate||Y;var x=o||"YYYY-MM-DDTHH:mm:ssZ",C=a.z(this),B=this.$H,v=this.$m,M=this.$M,A=l.weekdays,V=l.months,E=function(X,ee,Pe,pe){return X&&(X[ee]||X(w,x))||Pe[ee].slice(0,pe)},G=function(X){return a.s(B%12||12,X,"0")},J=l.meridiem||function(X,ee,Pe){var pe=X<12?"AM":"PM";return Pe?pe.toLowerCase():pe},ie={YY:String(this.$y).slice(-2),YYYY:this.$y,M:M+1,MM:a.s(M+1,2,"0"),MMM:E(l.monthsShort,M,V,3),MMMM:E(V,M),D:this.$D,DD:a.s(this.$D,2,"0"),d:String(this.$W),dd:E(l.weekdaysMin,this.$W,A,2),ddd:E(l.weekdaysShort,this.$W,A,3),dddd:A[this.$W],H:String(B),HH:a.s(B,2,"0"),h:G(1),hh:G(2),a:J(B,v,!0),A:J(B,v,!1),m:String(v),mm:a.s(v,2,"0"),s:String(this.$s),ss:a.s(this.$s,2,"0"),SSS:a.s(this.$ms,3,"0"),Z:C};return x.replace(F,function(X,ee){return ee||ie[X]||C.replace(":","")})},n.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},n.diff=function(o,w,l){var x,C=a.p(w),B=k(o),v=(B.utcOffset()-this.utcOffset())*t,M=this-B,A=a.m(this,B);return A=(x={},x[R]=A/12,x[y]=A,x[I]=A/3,x[m]=(M-v)/6048e5,x[h]=(M-v)/864e5,x[P]=M/f,x[T]=M/t,x[D]=M/g,x)[C]||M,l?A:a.a(A)},n.daysInMonth=function(){return this.endOf(y).$D},n.$locale=function(){return r[this.$L]},n.locale=function(o,w){if(!o)return this.$L;var l=this.clone(),x=z(o,w,!0);return x&&(l.$L=x),l},n.clone=function(){return a.w(this.$d,this)},n.toDate=function(){return new Date(this.valueOf())},n.toJSON=function(){return this.isValid()?this.toISOString():null},n.toISOString=function(){return this.$d.toISOString()},n.toString=function(){return this.$d.toUTCString()},s}(),$=_.prototype;return k.prototype=$,[["$ms",i],["$s",D],["$m",T],["$H",P],["$W",h],["$M",y],["$y",R],["$D",U]].forEach(function(s){$[s[1]]=function(n){return this.$g(n,s[0],s[1])}}),k.extend=function(s,n){return s.$i||(s(n,_,k),s.$i=!0),k},k.locale=z,k.isDayjs=d,k.unix=function(s){return k(1e3*s)},k.en=r[S],k.Ls=r,k.p={},k})})(rt);var ca=rt.exports;const Ve=ua(ca);const da={class:"audio-player"},fa=["src"],va={class:"time-display"},ma={class:"volume-control"},ha={__name:"audioPlay",props:{audioUrl:String},setup(e){const c=L(null),g=L(!1),t=L(0),f=L(0),i=L(0),D=L(1),T=L(!1);L(i.value);const P=L(1),h=()=>{g.value?c.value.pause():c.value.play(),g.value=!g.value},m=()=>{T.value||(t.value=c.value.currentTime,i.value=t.value/f.value*100)},y=()=>{f.value=c.value.duration},I=u=>{const S=Math.floor(u/60),r=Math.floor(u%60);return`${S}:${r.toString().padStart(2,"0")}`},R=u=>{P.value=u.target.value,c.value.volume=u.target.value},U=()=>{D.value===0?(c.value.volume=P.value,D.value=P.value):(c.value.volume=0,D.value=0)};let Y=0,b=0;const F=u=>{T.value=!0,Y=u.touches[0].clientX,b=i.value},O=u=>{if(T.value){const r=(u.touches[0].clientX-Y)/u.target.clientWidth*100;i.value=Math.min(100,Math.max(0,b+r))}},N=()=>{T.value=!1,c.value.currentTime=i.value/100*f.value};return fe(()=>{c.value.volume=D.value}),(u,S)=>{const r=ne;return re(),Se("div",da,[j("audio",{ref_key:"audioPlayer",ref:c,src:e.audioUrl,onTimeupdate:m,onLoadedmetadata:y},null,40,fa),j("div",{class:"play-btn",onClick:h},[g.value?(re(),Ue(r,{key:1,name:"pause-circle"})):(re(),Ue(r,{key:0,name:"play-circle"}))]),j("div",{class:"progress-bar",onTouchstart:F,onTouchmove:O,onTouchend:N},[j("div",{class:"progress",style:xt({width:i.value+"%","--after-width":i.value+"%"})},null,4)],32),j("div",va,Oe(I(t.value))+" / "+Oe(I(f.value)),1),j("div",ma,[j("span",{onClick:U},[p(r,{name:"volume"})]),ze(j("input",{type:"range","onUpdate:modelValue":S[0]||(S[0]=d=>D.value=d),min:"0",max:"1",step:"0.1",onInput:R},null,544),[[Ct,D.value]])])])}}},ga=Je(ha,[["__scopeId","data-v-c36ab43b"]]);const wa={class:"home text-center"},ya={key:0,class:"upload-box"},pa={key:1,class:"audio-resouse"},$a={style:{width:"100%",padding:"0 0.3rem"}},ba={class:"audition"},_a=["src"],Sa={__name:"AudioView",setup(e){const c=L(""),g=L(null),t=L(""),f=L(""),i=L([]),D=L(""),T=L(null),P=L(null),h=new(window.AudioContext||window.webkitAudioContext),m=L(null);L(null);const y=L(null);fe(()=>{I()});const I=()=>{c.value=Ve().format("YYYY-MM-DD HH:mm:ss"),g.value=setInterval(()=>{c.value=Ve().format("YYYY-MM-DD HH:mm:ss")},1e3)},R=()=>{if(!y.value){ve("片段不能为空");return}Wt({title:"下载提示：浏览器打开进行下载",message:`
        <a href="${D.value}" id="linkText" target="_blank">https://myd-website.github.io/audio/</a>
        <input
          style="width: 100%;"
          class="customFileName"
          value="${y.value}"
          type="text"
          colon
          placeholder="请输入文件名称"
        />`,allowHtml:!0,theme:"round-button"}).then(()=>{const r=document.getElementsByClassName("customFileName")[0].value;if(r)y.value=r.includes("mp3")?r:`${r}.mp3`,U(),Y();else{ve("文件名称不能为空");return}})},U=async()=>{const r=document.createRange();r.selectNode(document.querySelector("#linkText"));const d=window.getSelection();d.rangeCount>0&&d.removeAllRanges(),d.addRange(r),document.execCommand("Copy"),ve("复制成功")},Y=r=>{const d=document.createElement("a");d.href=D.value,d.download=y.value,d.click()},b=r=>(console.log(r,"file上传中"),r.status="uploading",r.message="上传中...",!0),F=r=>{console.log(r,"file上传成功"),f.value=r.file.name,t.value=URL.createObjectURL(r.file),N(r.file)},O=r=>{console.log(r,"file上传成功"),f.value="",t.value="",i.value=[]},N=r=>{if(!r)return;const d=new FileReader;d.onload=async()=>{const z=d.result;m.value=await h.decodeAudioData(z)},d.readAsArrayBuffer(r)},u=async(r,d)=>{const z=i.value[0];if(!z.file){ve("请先选择一个音频文件");return}if(Number(r)>=Number(d)){ve("请输入有效的时间段");return}const k=new(window.AudioContext||window.webkitAudioContext),a=await z.file.arrayBuffer(),_=await k.decodeAudioData(a),$=2,s=(d-r)*_.sampleRate,n=_.sampleRate,o=k.createBuffer($,s,n);for(let l=0;l<_.numberOfChannels;l++){const x=_.getChannelData(l);o.getChannelData(l).set(x.subarray(r*_.sampleRate,d*_.sampleRate))}const w=await S(o);D.value=URL.createObjectURL(w),y.value=`[${r}秒~${d}秒片段]_${f.value}`};function S(r){let d=r.numberOfChannels,z=r.length*d*2+44,k=0,a=new DataView(new ArrayBuffer(z)),_=[],$,s,n=0;for(w(1179011410),w(z-8),w(1163280727),w(544501094),w(16),o(1),o(d),w(r.sampleRate),w(r.sampleRate*2*d),o(d*2),o(16),w(1635017060),w(z-n-4),$=0;$<r.numberOfChannels;$++)_.push(r.getChannelData($));for(;n<z;){for($=0;$<d;$++)s=Math.max(-1,Math.min(1,_[$][k])),s=(.5+s<0?s*32768:s*32767)|0,a.setInt16(n,s,!0),n+=2;k++}return new Blob([a],{type:"audio/wav"});function o(l){a.setUint16(n,l,!0),n+=2}function w(l){a.setUint32(n,l,!0),n+=4}}return Ce(()=>{clearInterval(g)}),(r,d)=>{const z=Tt,k=sa,a=Pt,_=Dt,$=kt;return re(),Se("div",wa,[p(z,{"left-icon":"volume-o",text:`当前时间：${c.value}`},null,8,["text"]),t.value?Ye("",!0):(re(),Se("div",ya,[d[4]||(d[4]=j("p",{class:"mg10"},"请上传音频文件：",-1)),p(k,{modelValue:i.value,"onUpdate:modelValue":d[0]||(d[0]=s=>i.value=s),"max-count":1,"before-read":b,"after-read":F,"before-delete":O,accept:"audio/mp3"},null,8,["modelValue"])])),t.value?(re(),Se("div",pa,[j("span",null,Oe(f.value),1),j("div",$a,[p(ga,{audioUrl:t.value},null,8,["audioUrl"])]),p(_,{inset:""},{default:Te(()=>[p(a,{modelValue:T.value,"onUpdate:modelValue":d[1]||(d[1]=s=>T.value=s),type:"number",colon:"",placeholder:"请输入开始时间",label:"开始时间/秒"},null,8,["modelValue"]),p(a,{modelValue:P.value,"onUpdate:modelValue":d[2]||(d[2]=s=>P.value=s),type:"number",colon:"",placeholder:"请输入结束时间",label:"结束时间/秒"},null,8,["modelValue"])]),_:1}),p($,{type:"success",onClick:d[3]||(d[3]=s=>u(T.value,P.value))},{default:Te(()=>d[5]||(d[5]=[Ie("截取片段")])),_:1}),j("p",ba,[d[6]||(d[6]=Ie(" 试听： ")),j("audio",{src:D.value,controls:"",autoplay:"false"},null,8,_a)]),p($,{type:"success",onClick:R},{default:Te(()=>d[7]||(d[7]=[Ie("下载")])),_:1})])):Ye("",!0)])}}},Ra=Je(Sa,[["__scopeId","data-v-f8cc6972"]]);export{Ra as default};
