import{c as ie,t as Z,n as K,m as G,d as oe,r as L,a as $e,u as vt,b as H,w as J,e as Ge,f as qe,g as mt,o as fe,h as ht,i as gt,j as wt,k as Pe,l as ze,p as $,q as Se,s as Ne,v as be,x as ye,y as ee,z as ve,A as yt,B as bt,C as Ce,D as Je,E as Re,F as ae,G as Le,H as $t,I as ce,J as ne,K as de,L as ge,M as _t,N as Ke,O as Ee,P as we,Q as Oe,R as St,S as Qe,T as et,U as Fe,V as xt,W as Ct,X as Ue,Y as tt,Z as pt,_ as Dt,$ as Pt,a0 as at,a1 as ue,a2 as pe,a3 as j,a4 as He,a5 as Be,a6 as Mt,a7 as We,a8 as Ie,a9 as ke}from"./index.js";import{C as Tt}from"./index3.js";import"./index4.js";import{F as It}from"./index5.js";import{s as kt}from"./index6.js";import{N as At}from"./index7.js";import{u as Ye,m as nt,a as ot,P as Ot,s as me}from"./function-call.js";import{u as Me}from"./use-expose.js";import{L as it}from"./index8.js";import{B as Bt}from"./index9.js";const[lt,xe]=ie("swipe"),Vt={loop:Z,width:K,height:K,vertical:Boolean,autoplay:G(0),duration:G(500),touchable:Z,lazyRender:Boolean,initialSwipe:G(0),indicatorColor:String,showIndicators:Z,stopPropagation:Z},st=Symbol(lt);var zt=oe({name:lt,props:Vt,emits:["change","dragStart","dragEnd"],setup(e,{emit:c,slots:h}){const n=L(),u=L(),i=$e({rect:null,width:0,height:0,offset:0,active:0,swiping:!1});let D=!1;const A=Ye(),{children:C,linkChildren:v}=vt(st),d=H(()=>C.length),_=H(()=>i[e.vertical?"height":"width"]),M=H(()=>e.vertical?A.deltaY.value:A.deltaX.value),O=H(()=>i.rect?(e.vertical?i.rect.height:i.rect.width)-_.value*d.value:0),U=H(()=>_.value?Math.ceil(Math.abs(O.value)/_.value):d.value),N=H(()=>d.value*_.value),S=H(()=>(i.active+d.value)%d.value),V=H(()=>{const w=e.vertical?"vertical":"horizontal";return A.direction.value===w}),x=H(()=>{const w={transitionDuration:`${i.swiping?0:e.duration}ms`,transform:`translate${e.vertical?"Y":"X"}(${i.offset}px)`};if(_.value){const k=e.vertical?"height":"width",B=e.vertical?"width":"height";w[k]=`${N.value}px`,w[B]=e[B]?`${e[B]}px`:""}return w}),Y=w=>{const{active:k}=i;return w?e.loop?ee(k+w,-1,d.value):ee(k+w,0,U.value):k},y=(w,k=0)=>{let B=w*_.value;e.loop||(B=Math.min(B,-O.value));let F=k-B;return e.loop||(F=ee(F,O.value,0)),F},T=({pace:w=0,offset:k=0,emitChange:B})=>{if(d.value<=1)return;const{active:F}=i,E=Y(w),q=y(E,k);if(e.loop){if(C[0]&&q!==O.value){const Q=q<O.value;C[0].setOffset(Q?N.value:0)}if(C[d.value-1]&&q!==0){const Q=q>0;C[d.value-1].setOffset(Q?-N.value:0)}}i.active=E,i.offset=q,B&&E!==F&&c("change",S.value)},f=()=>{i.swiping=!0,i.active<=-1?T({pace:d.value}):i.active>=d.value&&T({pace:-d.value})},m=()=>{f(),A.reset(),Se(()=>{i.swiping=!1,T({pace:-1,emitChange:!0})})},z=()=>{f(),A.reset(),Se(()=>{i.swiping=!1,T({pace:1,emitChange:!0})})};let I;const t=()=>clearTimeout(I),r=()=>{t(),+e.autoplay>0&&d.value>1&&(I=setTimeout(()=>{z(),r()},+e.autoplay))},g=(w=+e.initialSwipe)=>{if(!n.value)return;const k=()=>{var B,F;if(!Ne(n)){const E={width:n.value.offsetWidth,height:n.value.offsetHeight};i.rect=E,i.width=+((B=e.width)!=null?B:E.width),i.height=+((F=e.height)!=null?F:E.height)}d.value&&(w=Math.min(d.value-1,w),w===-1&&(w=d.value-1)),i.active=w,i.swiping=!0,i.offset=y(w),C.forEach(E=>{E.setOffset(0)}),r()};Ne(n)?be().then(k):k()},s=()=>g(i.active);let a;const o=w=>{!e.touchable||w.touches.length>1||(A.start(w),D=!1,a=Date.now(),t(),f())},b=w=>{e.touchable&&i.swiping&&(A.move(w),V.value&&(!e.loop&&(i.active===0&&M.value>0||i.active===d.value-1&&M.value<0)||(ye(w,e.stopPropagation),T({offset:M.value}),D||(c("dragStart",{index:S.value}),D=!0))))},l=()=>{if(!e.touchable||!i.swiping)return;const w=Date.now()-a,k=M.value/w;if((Math.abs(k)>.25||Math.abs(M.value)>_.value/2)&&V.value){const F=e.vertical?A.offsetY.value:A.offsetX.value;let E=0;e.loop?E=F>0?M.value>0?-1:1:0:E=-Math[M.value>0?"ceil":"floor"](M.value/_.value),T({pace:E,emitChange:!0})}else M.value&&T({pace:0});D=!1,i.swiping=!1,c("dragEnd",{index:S.value}),r()},p=(w,k={})=>{f(),A.reset(),Se(()=>{let B;e.loop&&w===d.value?B=i.active===0?0:w:B=w%d.value,k.immediate?Se(()=>{i.swiping=!1}):i.swiping=!1,T({pace:B-i.active,emitChange:!0})})},P=(w,k)=>{const B=k===S.value,F=B?{backgroundColor:e.indicatorColor}:void 0;return $("i",{style:F,class:xe("indicator",{active:B})},null)},R=()=>{if(h.indicator)return h.indicator({active:S.value,total:d.value});if(e.showIndicators&&d.value>1)return $("div",{class:xe("indicators",{vertical:e.vertical})},[Array(d.value).fill("").map(P)])};return Me({prev:m,next:z,state:i,resize:s,swipeTo:p}),v({size:_,props:e,count:d,activeIndicator:S}),J(()=>e.initialSwipe,w=>g(+w)),J(d,()=>g(i.active)),J(()=>e.autoplay,r),J([Ge,qe,()=>e.width,()=>e.height],s),J(mt(),w=>{w==="visible"?r():t()}),fe(g),ht(()=>g(i.active)),gt(()=>g(i.active)),wt(t),Pe(t),ze("touchmove",b,{target:u}),()=>{var w;return $("div",{ref:n,class:xe()},[$("div",{ref:u,style:x.value,class:xe("track",{vertical:e.vertical}),onTouchstartPassive:o,onTouchend:l,onTouchcancel:l},[(w=h.default)==null?void 0:w.call(h)]),R()])}}});const Rt=ve(zt),[Lt,Ut]=ie("swipe-item");var Yt=oe({name:Lt,setup(e,{slots:c}){let h;const n=$e({offset:0,inited:!1,mounted:!1}),{parent:u,index:i}=yt(st);if(!u)return;const D=H(()=>{const v={},{vertical:d}=u.props;return u.size.value&&(v[d?"height":"width"]=`${u.size.value}px`),n.offset&&(v.transform=`translate${d?"Y":"X"}(${n.offset}px)`),v}),A=H(()=>{const{loop:v,lazyRender:d}=u.props;if(!d||h)return!0;if(!n.mounted)return!1;const _=u.activeIndicator.value,M=u.count.value-1,O=_===0&&v?M:_-1,U=_===M&&v?0:_+1;return h=i.value===_||i.value===O||i.value===U,h}),C=v=>{n.offset=v};return fe(()=>{be(()=>{n.mounted=!0})}),Me({setOffset:C}),()=>{var v;return $("div",{class:Ut(),style:D.value},[A.value?(v=c.default)==null?void 0:v.call(c):null])}}});const Nt=ve(Yt),[Et,se]=ie("image"),Ft={src:String,alt:String,fit:String,position:String,round:Boolean,block:Boolean,width:K,height:K,radius:K,lazyLoad:Boolean,iconSize:K,showError:Z,errorIcon:ae("photo-fail"),iconPrefix:String,showLoading:Z,loadingIcon:ae("photo")};var Ht=oe({name:Et,props:Ft,emits:["load","error"],setup(e,{emit:c,slots:h}){const n=L(!1),u=L(!0),i=L(),{$Lazyload:D}=bt().proxy,A=H(()=>{const S={width:Ce(e.width),height:Ce(e.height)};return Je(e.radius)&&(S.overflow="hidden",S.borderRadius=Ce(e.radius)),S});J(()=>e.src,()=>{n.value=!1,u.value=!0});const C=S=>{u.value&&(u.value=!1,c("load",S))},v=()=>{const S=new Event("load");Object.defineProperty(S,"target",{value:i.value,enumerable:!0}),C(S)},d=S=>{n.value=!0,u.value=!1,c("error",S)},_=(S,V,x)=>x?x():$(ne,{name:S,size:e.iconSize,class:V,classPrefix:e.iconPrefix},null),M=()=>{if(u.value&&e.showLoading)return $("div",{class:se("loading")},[_(e.loadingIcon,se("loading-icon"),h.loading)]);if(n.value&&e.showError)return $("div",{class:se("error")},[_(e.errorIcon,se("error-icon"),h.error)])},O=()=>{if(n.value||!e.src)return;const S={alt:e.alt,class:se("img"),style:{objectFit:e.fit,objectPosition:e.position}};return e.lazyLoad?Le($("img",ce({ref:i},S),null),[[$t("lazy"),e.src]]):$("img",ce({ref:i,src:e.src,onLoad:C,onError:d},S),null)},U=({el:S})=>{const V=()=>{S===i.value&&u.value&&v()};i.value?V():be(V)},N=({el:S})=>{S===i.value&&!n.value&&d()};return D&&Re&&(D.$on("loaded",U),D.$on("error",N),Pe(()=>{D.$off("loaded",U),D.$off("error",N)})),fe(()=>{be(()=>{var S;(S=i.value)!=null&&S.complete&&!e.lazyLoad&&v()})}),()=>{var S;return $("div",{class:se({round:e.round,block:e.block}),style:A.value},[O(),M(),(S=h.default)==null?void 0:S.call(h)])}}});const rt=ve(Ht);let Ve;const Wt={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1};let Xt=de({},Wt);function Zt(){({instance:Ve}=nt({setup(){const{state:c,toggle:h}=ot();return()=>$(kt,ce(c,{"onUpdate:show":h}),null)}}))}function jt(e){return Re?new Promise((c,h)=>{Ve||Zt(),Ve.open(de({},Xt,e,{callback:n=>{(n==="confirm"?c:h)(n)}}))}):Promise.resolve()}const Xe=e=>Math.sqrt((e[0].clientX-e[1].clientX)**2+(e[0].clientY-e[1].clientY)**2),Ae=ie("image-preview")[1];var Gt=oe({props:{src:String,show:Boolean,active:Number,minZoom:ge(K),maxZoom:ge(K),rootWidth:ge(Number),rootHeight:ge(Number),disableZoom:Boolean},emits:["scale","close","longPress"],setup(e,{emit:c,slots:h}){const n=$e({scale:1,moveX:0,moveY:0,moving:!1,zooming:!1,imageRatio:0,displayWidth:0,displayHeight:0}),u=Ye(),i=L(),D=H(()=>{const{rootWidth:t,rootHeight:r}=e,g=r/t;return n.imageRatio>g}),A=H(()=>{const{scale:t,moveX:r,moveY:g,moving:s,zooming:a}=n,o={transitionDuration:a||s?"0s":".3s"};if(t!==1){const b=r/t,l=g/t;o.transform=`scale(${t}, ${t}) translate(${b}px, ${l}px)`}return o}),C=H(()=>{if(n.imageRatio){const{rootWidth:t,rootHeight:r}=e,g=D.value?r/n.imageRatio:t;return Math.max(0,(n.scale*g-t)/2)}return 0}),v=H(()=>{if(n.imageRatio){const{rootWidth:t,rootHeight:r}=e,g=D.value?r:t*n.imageRatio;return Math.max(0,(n.scale*g-r)/2)}return 0}),d=t=>{t=ee(t,+e.minZoom,+e.maxZoom+1),t!==n.scale&&(n.scale=t,c("scale",{scale:t,index:e.active}))},_=()=>{d(1),n.moveX=0,n.moveY=0},M=()=>{const t=n.scale>1?1:2;d(t),n.moveX=0,n.moveY=0};let O,U,N,S,V,x,Y,y=!1;const T=t=>{const{touches:r}=t;if(O=r.length,O===2&&e.disableZoom)return;const{offsetX:g}=u;u.start(t),U=n.moveX,N=n.moveY,Y=Date.now(),y=!1,n.moving=O===1&&n.scale!==1,n.zooming=O===2&&!g.value,n.zooming&&(S=n.scale,V=Xe(t.touches))},f=t=>{const{touches:r}=t;if(u.move(t),n.moving){const{deltaX:g,deltaY:s}=u,a=g.value+U,o=s.value+N;if((a>C.value||a<-C.value)&&!y&&u.isHorizontal()){n.moving=!1;return}y=!0,ye(t,!0),n.moveX=ee(a,-C.value,C.value),n.moveY=ee(o,-v.value,v.value)}if(n.zooming&&(ye(t,!0),r.length===2)){const g=Xe(r),s=S*g/V;d(s)}},m=()=>{if(O>1)return;const{offsetX:t,offsetY:r}=u,g=Date.now()-Y,s=250,a=5;t.value<a&&r.value<a&&(g<s?x?(clearTimeout(x),x=null,M()):x=setTimeout(()=>{c("close"),x=null},s):g>_t&&c("longPress"))},z=t=>{let r=!1;if((n.moving||n.zooming)&&(r=!0,n.moving&&U===n.moveX&&N===n.moveY&&(r=!1),!t.touches.length)){n.zooming&&(n.moveX=ee(n.moveX,-C.value,C.value),n.moveY=ee(n.moveY,-v.value,v.value),n.zooming=!1),n.moving=!1,U=0,N=0,S=1,n.scale<1&&_();const g=+e.maxZoom;n.scale>g&&(n.scale=g)}ye(t,r),m(),u.reset()},I=t=>{const{naturalWidth:r,naturalHeight:g}=t.target;n.imageRatio=g/r};return J(()=>e.active,_),J(()=>e.show,t=>{t||_()}),ze("touchmove",f,{target:H(()=>{var t;return(t=i.value)==null?void 0:t.$el})}),()=>{const t={loading:()=>$(it,{type:"spinner"},null)};return $(Nt,{ref:i,class:Ae("swipe-item"),onTouchstartPassive:T,onTouchend:z,onTouchcancel:z},{default:()=>[h.image?$("div",{class:Ae("image-wrap")},[h.image({src:e.src})]):$(rt,{src:e.src,fit:"contain",class:Ae("image",{vertical:D.value}),style:A.value,onLoad:I},t)]})}}});const[qt,re]=ie("image-preview"),Jt=["show","teleport","transition","overlayStyle","closeOnPopstate"],Kt={show:Boolean,loop:Z,images:Ke(),minZoom:G(1/3),maxZoom:G(3),overlay:Z,closeable:Boolean,showIndex:Z,className:Ee,closeIcon:ae("clear"),transition:String,beforeClose:Function,overlayClass:Ee,overlayStyle:Object,swipeDuration:G(300),startPosition:G(0),showIndicators:Boolean,closeOnPopstate:Z,closeIconPosition:ae("top-right"),teleport:[String,Object]};var ut=oe({name:qt,props:Kt,emits:["scale","close","closed","change","longPress","update:show"],setup(e,{emit:c,slots:h}){const n=L(),u=$e({active:0,rootWidth:0,rootHeight:0,disableZoom:!1}),i=()=>{if(n.value){const x=Oe(n.value.$el);u.rootWidth=x.width,u.rootHeight=x.height,n.value.resize()}},D=x=>c("scale",x),A=x=>c("update:show",x),C=()=>{Qe(e.beforeClose,{args:[u.active],done:()=>A(!1)})},v=x=>{x!==u.active&&(u.active=x,c("change",x))},d=()=>{if(e.showIndex)return $("div",{class:re("index")},[h.index?h.index({index:u.active}):`${u.active+1} / ${e.images.length}`])},_=()=>{if(h.cover)return $("div",{class:re("cover")},[h.cover()])},M=()=>{u.disableZoom=!0},O=()=>{u.disableZoom=!1},U=()=>$(Rt,{ref:n,lazyRender:!0,loop:e.loop,class:re("swipe"),duration:e.swipeDuration,initialSwipe:e.startPosition,showIndicators:e.showIndicators,indicatorColor:"white",onChange:v,onDragEnd:O,onDragStart:M},{default:()=>[e.images.map((x,Y)=>$(Gt,{src:x,show:e.show,active:u.active,maxZoom:e.maxZoom,minZoom:e.minZoom,rootWidth:u.rootWidth,rootHeight:u.rootHeight,disableZoom:u.disableZoom,onScale:D,onClose:C,onLongPress:()=>c("longPress",{index:Y})},{image:h.image}))]}),N=()=>{if(e.closeable)return $(ne,{role:"button",name:e.closeIcon,class:[re("close-icon",e.closeIconPosition),St],onClick:C},null)},S=()=>c("closed"),V=(x,Y)=>{var y;return(y=n.value)==null?void 0:y.swipeTo(x,Y)};return Me({swipeTo:V}),fe(i),J([Ge,qe],i),J(()=>e.startPosition,x=>v(+x)),J(()=>e.show,x=>{const{images:Y,startPosition:y}=e;x?(v(+y),be(()=>{i(),V(+y,{immediate:!0})})):c("close",{index:u.active,url:Y[u.active]})}),()=>$(Ot,ce({class:[re(),e.className],overlayClass:[re("overlay"),e.overlayClass],onClosed:S,"onUpdate:show":A},we(e,Jt)),{default:()=>[N(),U(),d(),_()]})}});let De;const Qt={loop:!0,images:[],maxZoom:3,minZoom:1/3,onScale:void 0,onClose:void 0,onChange:void 0,teleport:"body",className:"",showIndex:!0,closeable:!1,closeIcon:"clear",transition:void 0,beforeClose:void 0,overlayStyle:void 0,overlayClass:void 0,startPosition:0,swipeDuration:300,showIndicators:!1,closeOnPopstate:!0,closeIconPosition:"top-right"};function ea(){({instance:De}=nt({setup(){const{state:e,toggle:c}=ot(),h=()=>{e.images=[]};return()=>$(ut,ce(e,{onClosed:h,"onUpdate:show":c}),null)}}))}const ta=(e,c=0)=>{if(Re)return De||ea(),e=Array.isArray(e)?{images:e,startPosition:c}:e,De.open(de({},Qt,e)),De};ve(ut);const[aa,he]=ie("slider"),na={min:G(0),max:G(100),step:G(1),range:Boolean,reverse:Boolean,disabled:Boolean,readonly:Boolean,vertical:Boolean,barHeight:K,buttonSize:K,activeColor:String,inactiveColor:String,modelValue:{type:[Number,Array],default:0}};var oa=oe({name:aa,props:na,emits:["change","dragEnd","dragStart","update:modelValue"],setup(e,{emit:c,slots:h}){let n,u,i;const D=L(),A=[L(),L()],C=L(),v=Ye(),d=H(()=>Number(e.max)-Number(e.min)),_=H(()=>{const t=e.vertical?"width":"height";return{background:e.inactiveColor,[t]:Ce(e.barHeight)}}),M=t=>e.range&&Array.isArray(t),O=()=>{const{modelValue:t,min:r}=e;return M(t)?`${(t[1]-t[0])*100/d.value}%`:`${(t-Number(r))*100/d.value}%`},U=()=>{const{modelValue:t,min:r}=e;return M(t)?`${(t[0]-Number(r))*100/d.value}%`:"0%"},N=H(()=>{const r={[e.vertical?"height":"width"]:O(),background:e.activeColor};C.value&&(r.transition="none");const g=()=>e.vertical?e.reverse?"bottom":"top":e.reverse?"right":"left";return r[g()]=U(),r}),S=t=>{const r=+e.min,g=+e.max,s=+e.step;t=ee(t,r,g);const a=Math.round((t-r)/s)*s;return Ct(r,a)},V=t=>{var r,g;const s=(r=t[0])!=null?r:Number(e.min),a=(g=t[1])!=null?g:Number(e.max);return s>a?[a,s]:[s,a]},x=(t,r)=>{M(t)?t=V(t).map(S):t=S(t),Fe(t,e.modelValue)||c("update:modelValue",t),r&&!Fe(t,i)&&c("change",t)},Y=t=>{if(t.stopPropagation(),e.disabled||e.readonly)return;const{min:r,reverse:g,vertical:s,modelValue:a}=e,o=Oe(D),b=()=>s?g?o.bottom-t.clientY:t.clientY-o.top:g?o.right-t.clientX:t.clientX-o.left,l=s?o.height:o.width,p=Number(r)+b()/l*d.value;if(M(a)){const[P,R]=a,w=(P+R)/2;p<=w?x([p,R],!0):x([P,p],!0)}else x(p,!0)},y=t=>{e.disabled||e.readonly||(v.start(t),u=e.modelValue,M(u)?i=u.map(S):i=S(u),C.value="start")},T=t=>{if(e.disabled||e.readonly)return;C.value==="start"&&c("dragStart",t),ye(t,!0),v.move(t),C.value="dragging";const r=Oe(D),g=e.vertical?v.deltaY.value:v.deltaX.value,s=e.vertical?r.height:r.width;let a=g/s*d.value;if(e.reverse&&(a=-a),M(i)){const o=e.reverse?1-n:n;u[o]=i[o]+a}else u=i+a;x(u)},f=t=>{e.disabled||e.readonly||(C.value==="dragging"&&(x(u,!0),c("dragEnd",t)),C.value="")},m=t=>typeof t=="number"?he("button-wrapper",["left","right"][t]):he("button-wrapper",e.reverse?"left":"right"),z=(t,r)=>{if(typeof r=="number"){const g=h[r===0?"left-button":"right-button"];if(g)return g({value:t})}return h.button?h.button({value:t}):$("div",{class:he("button"),style:Ue(e.buttonSize)},null)},I=t=>{const r=typeof t=="number"?e.modelValue[t]:e.modelValue;return $("div",{ref:A[t??0],role:"slider",class:m(t),tabindex:e.disabled?void 0:0,"aria-valuemin":e.min,"aria-valuenow":r,"aria-valuemax":e.max,"aria-disabled":e.disabled||void 0,"aria-readonly":e.readonly||void 0,"aria-orientation":e.vertical?"vertical":"horizontal",onTouchstartPassive:g=>{typeof t=="number"&&(n=t),y(g)},onTouchend:f,onTouchcancel:f,onClick:xt},[z(r,t)])};return x(e.modelValue),et(()=>e.modelValue),A.forEach(t=>{ze("touchmove",T,{target:t})}),()=>$("div",{ref:D,style:_.value,class:he({vertical:e.vertical,disabled:e.disabled}),onClick:Y},[$("div",{class:he("bar"),style:N.value},[e.range?[I(0),I(1)]:I()])])}});const ia=ve(oa),[la,W,sa]=ie("uploader");function Ze(e,c){return new Promise(h=>{if(c==="file"){h();return}const n=new FileReader;n.onload=u=>{h(u.target.result)},c==="dataUrl"?n.readAsDataURL(e):c==="text"&&n.readAsText(e)})}function ct(e,c){return tt(e).some(h=>h.file?pt(c)?c(h.file):h.file.size>+c:!1)}function ra(e,c){const h=[],n=[];return e.forEach(u=>{ct(u,c)?n.push(u):h.push(u)}),{valid:h,invalid:n}}const ua=/\.(jpeg|jpg|gif|png|svg|webp|jfif|bmp|dpg|avif)/i,ca=e=>ua.test(e);function dt(e){return e.isImage?!0:e.file&&e.file.type?e.file.type.indexOf("image")===0:e.url?ca(e.url):typeof e.content=="string"?e.content.indexOf("data:image")===0:!1}var da=oe({props:{name:K,item:ge(Object),index:Number,imageFit:String,lazyLoad:Boolean,deletable:Boolean,previewSize:[Number,String,Array],beforeDelete:Function},emits:["delete","preview"],setup(e,{emit:c,slots:h}){const n=()=>{const{status:v,message:d}=e.item;if(v==="uploading"||v==="failed"){const _=v==="failed"?$(ne,{name:"close",class:W("mask-icon")},null):$(it,{class:W("loading")},null),M=Je(d)&&d!=="";return $("div",{class:W("mask")},[_,M&&$("div",{class:W("mask-message")},[d])])}},u=v=>{const{name:d,item:_,index:M,beforeDelete:O}=e;v.stopPropagation(),Qe(O,{args:[_,{name:d,index:M}],done:()=>c("delete")})},i=()=>c("preview"),D=()=>{if(e.deletable&&e.item.status!=="uploading"){const v=h["preview-delete"];return $("div",{role:"button",class:W("preview-delete",{shadow:!v}),tabindex:0,"aria-label":sa("delete"),onClick:u},[v?v():$(ne,{name:"cross",class:W("preview-delete-icon")},null)])}},A=()=>{if(h["preview-cover"]){const{index:v,item:d}=e;return $("div",{class:W("preview-cover")},[h["preview-cover"](de({index:v},d))])}},C=()=>{const{item:v,lazyLoad:d,imageFit:_,previewSize:M}=e;return dt(v)?$(rt,{fit:_,src:v.content||v.url,class:W("preview-image"),width:Array.isArray(M)?M[0]:M,height:Array.isArray(M)?M[1]:M,lazyLoad:d,onClick:i},{default:A}):$("div",{class:W("file"),style:Ue(e.previewSize)},[$(ne,{class:W("file-icon"),name:"description"},null),$("div",{class:[W("file-name"),"van-ellipsis"]},[v.file?v.file.name:v.url]),A()])};return()=>$("div",{class:W("preview")},[C(),n(),D()])}});const fa={name:G(""),accept:ae("image/*"),capture:String,multiple:Boolean,disabled:Boolean,readonly:Boolean,lazyLoad:Boolean,maxCount:G(1/0),imageFit:ae("cover"),resultType:ae("dataUrl"),uploadIcon:ae("photograph"),uploadText:String,deletable:Z,afterRead:Function,showUpload:Z,modelValue:Ke(),beforeRead:Function,beforeDelete:Function,previewSize:[Number,String,Array],previewImage:Z,previewOptions:Object,previewFullImage:Z,maxSize:{type:[Number,String,Function],default:1/0}};var va=oe({name:la,props:fa,emits:["delete","oversize","clickUpload","closePreview","clickPreview","update:modelValue"],setup(e,{emit:c,slots:h}){const n=L(),u=[],i=(y=e.modelValue.length)=>({name:e.name,index:y}),D=()=>{n.value&&(n.value.value="")},A=y=>{if(D(),ct(y,e.maxSize))if(Array.isArray(y)){const T=ra(y,e.maxSize);if(y=T.valid,c("oversize",T.invalid,i()),!y.length)return}else{c("oversize",y,i());return}y=$e(y),c("update:modelValue",[...e.modelValue,...tt(y)]),e.afterRead&&e.afterRead(y,i())},C=y=>{const{maxCount:T,modelValue:f,resultType:m}=e;if(Array.isArray(y)){const z=+T-f.length;y.length>z&&(y=y.slice(0,z)),Promise.all(y.map(I=>Ze(I,m))).then(I=>{const t=y.map((r,g)=>{const s={file:r,status:"",message:""};return I[g]&&(s.content=I[g]),s});A(t)})}else Ze(y,m).then(z=>{const I={file:y,status:"",message:""};z&&(I.content=z),A(I)})},v=y=>{const{files:T}=y.target;if(e.disabled||!T||!T.length)return;const f=T.length===1?T[0]:[].slice.call(T);if(e.beforeRead){const m=e.beforeRead(f,i());if(!m){D();return}if(Pt(m)){m.then(z=>{C(z||f)}).catch(D);return}}C(f)};let d;const _=()=>c("closePreview"),M=y=>{if(e.previewFullImage){const T=e.modelValue.filter(dt),f=T.map(m=>(m.file&&!m.url&&m.status!=="failed"&&(m.url=URL.createObjectURL(m.file),u.push(m.url)),m.url)).filter(Boolean);d=ta(de({images:f,startPosition:T.indexOf(y),onClose:_},e.previewOptions))}},O=()=>{d&&d.close()},U=(y,T)=>{const f=e.modelValue.slice(0);f.splice(T,1),c("update:modelValue",f),c("delete",y,i(T))},N=(y,T)=>{const f=["imageFit","deletable","previewSize","beforeDelete"],m=de(we(e,f),we(y,f,!0));return $(da,ce({item:y,index:T,onClick:()=>c("clickPreview",y,i(T)),onDelete:()=>U(y,T),onPreview:()=>M(y)},we(e,["name","lazyLoad"]),m),we(h,["preview-cover","preview-delete"]))},S=()=>{if(e.previewImage)return e.modelValue.map(N)},V=y=>c("clickUpload",y),x=()=>{if(e.modelValue.length>=+e.maxCount)return;const y=e.readonly?null:$("input",{ref:n,type:"file",class:W("input"),accept:e.accept,capture:e.capture,multiple:e.multiple,disabled:e.disabled,onChange:v},null);return h.default?$("div",{class:W("input-wrapper"),onClick:V},[h.default(),y]):Le($("div",{class:W("upload",{readonly:e.readonly}),style:Ue(e.previewSize),onClick:V},[$(ne,{name:e.uploadIcon,class:W("upload-icon")},null),e.uploadText&&$("span",{class:W("upload-text")},[e.uploadText]),y]),[[Dt,e.showUpload]])},Y=()=>{n.value&&!e.disabled&&n.value.click()};return Pe(()=>{u.forEach(y=>URL.revokeObjectURL(y))}),Me({chooseFile:Y,closeImagePreview:O}),et(()=>e.modelValue),()=>$("div",{class:W()},[$("div",{class:W("wrapper",{disabled:e.disabled})},[S(),x()])])}});const ma=ve(va);var ha=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ga(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ft={exports:{}};(function(e,c){(function(h,n){e.exports=n()})(ha,function(){var h=1e3,n=6e4,u=36e5,i="millisecond",D="second",A="minute",C="hour",v="day",d="week",_="month",M="quarter",O="year",U="date",N="Invalid Date",S=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,V=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,x={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(s){var a=["th","st","nd","rd"],o=s%100;return"["+s+(a[(o-20)%10]||a[o]||a[0])+"]"}},Y=function(s,a,o){var b=String(s);return!b||b.length>=a?s:""+Array(a+1-b.length).join(o)+s},y={s:Y,z:function(s){var a=-s.utcOffset(),o=Math.abs(a),b=Math.floor(o/60),l=o%60;return(a<=0?"+":"-")+Y(b,2,"0")+":"+Y(l,2,"0")},m:function s(a,o){if(a.date()<o.date())return-s(o,a);var b=12*(o.year()-a.year())+(o.month()-a.month()),l=a.clone().add(b,_),p=o-l<0,P=a.clone().add(b+(p?-1:1),_);return+(-(b+(o-l)/(p?l-P:P-l))||0)},a:function(s){return s<0?Math.ceil(s)||0:Math.floor(s)},p:function(s){return{M:_,y:O,w:d,d:v,D:U,h:C,m:A,s:D,ms:i,Q:M}[s]||String(s||"").toLowerCase().replace(/s$/,"")},u:function(s){return s===void 0}},T="en",f={};f[T]=x;var m=function(s){return s instanceof r},z=function s(a,o,b){var l;if(!a)return T;if(typeof a=="string"){var p=a.toLowerCase();f[p]&&(l=p),o&&(f[p]=o,l=p);var P=a.split("-");if(!l&&P.length>1)return s(P[0])}else{var R=a.name;f[R]=a,l=R}return!b&&l&&(T=l),l||!b&&T},I=function(s,a){if(m(s))return s.clone();var o=typeof a=="object"?a:{};return o.date=s,o.args=arguments,new r(o)},t=y;t.l=z,t.i=m,t.w=function(s,a){return I(s,{locale:a.$L,utc:a.$u,x:a.$x,$offset:a.$offset})};var r=function(){function s(o){this.$L=z(o.locale,null,!0),this.parse(o)}var a=s.prototype;return a.parse=function(o){this.$d=function(b){var l=b.date,p=b.utc;if(l===null)return new Date(NaN);if(t.u(l))return new Date;if(l instanceof Date)return new Date(l);if(typeof l=="string"&&!/Z$/i.test(l)){var P=l.match(S);if(P){var R=P[2]-1||0,w=(P[7]||"0").substring(0,3);return p?new Date(Date.UTC(P[1],R,P[3]||1,P[4]||0,P[5]||0,P[6]||0,w)):new Date(P[1],R,P[3]||1,P[4]||0,P[5]||0,P[6]||0,w)}}return new Date(l)}(o),this.$x=o.x||{},this.init()},a.init=function(){var o=this.$d;this.$y=o.getFullYear(),this.$M=o.getMonth(),this.$D=o.getDate(),this.$W=o.getDay(),this.$H=o.getHours(),this.$m=o.getMinutes(),this.$s=o.getSeconds(),this.$ms=o.getMilliseconds()},a.$utils=function(){return t},a.isValid=function(){return this.$d.toString()!==N},a.isSame=function(o,b){var l=I(o);return this.startOf(b)<=l&&l<=this.endOf(b)},a.isAfter=function(o,b){return I(o)<this.startOf(b)},a.isBefore=function(o,b){return this.endOf(b)<I(o)},a.$g=function(o,b,l){return t.u(o)?this[b]:this.set(l,o)},a.unix=function(){return Math.floor(this.valueOf()/1e3)},a.valueOf=function(){return this.$d.getTime()},a.startOf=function(o,b){var l=this,p=!!t.u(b)||b,P=t.p(o),R=function(le,X){var te=t.w(l.$u?Date.UTC(l.$y,X,le):new Date(l.$y,X,le),l);return p?te:te.endOf(v)},w=function(le,X){return t.w(l.toDate()[le].apply(l.toDate("s"),(p?[0,0,0,0]:[23,59,59,999]).slice(X)),l)},k=this.$W,B=this.$M,F=this.$D,E="set"+(this.$u?"UTC":"");switch(P){case O:return p?R(1,0):R(31,11);case _:return p?R(1,B):R(0,B+1);case d:var q=this.$locale().weekStart||0,Q=(k<q?k+7:k)-q;return R(p?F-Q:F+(6-Q),B);case v:case U:return w(E+"Hours",0);case C:return w(E+"Minutes",1);case A:return w(E+"Seconds",2);case D:return w(E+"Milliseconds",3);default:return this.clone()}},a.endOf=function(o){return this.startOf(o,!1)},a.$set=function(o,b){var l,p=t.p(o),P="set"+(this.$u?"UTC":""),R=(l={},l[v]=P+"Date",l[U]=P+"Date",l[_]=P+"Month",l[O]=P+"FullYear",l[C]=P+"Hours",l[A]=P+"Minutes",l[D]=P+"Seconds",l[i]=P+"Milliseconds",l)[p],w=p===v?this.$D+(b-this.$W):b;if(p===_||p===O){var k=this.clone().set(U,1);k.$d[R](w),k.init(),this.$d=k.set(U,Math.min(this.$D,k.daysInMonth())).$d}else R&&this.$d[R](w);return this.init(),this},a.set=function(o,b){return this.clone().$set(o,b)},a.get=function(o){return this[t.p(o)]()},a.add=function(o,b){var l,p=this;o=Number(o);var P=t.p(b),R=function(B){var F=I(p);return t.w(F.date(F.date()+Math.round(B*o)),p)};if(P===_)return this.set(_,this.$M+o);if(P===O)return this.set(O,this.$y+o);if(P===v)return R(1);if(P===d)return R(7);var w=(l={},l[A]=n,l[C]=u,l[D]=h,l)[P]||1,k=this.$d.getTime()+o*w;return t.w(k,this)},a.subtract=function(o,b){return this.add(-1*o,b)},a.format=function(o){var b=this,l=this.$locale();if(!this.isValid())return l.invalidDate||N;var p=o||"YYYY-MM-DDTHH:mm:ssZ",P=t.z(this),R=this.$H,w=this.$m,k=this.$M,B=l.weekdays,F=l.months,E=function(X,te,Te,_e){return X&&(X[te]||X(b,p))||Te[te].slice(0,_e)},q=function(X){return t.s(R%12||12,X,"0")},Q=l.meridiem||function(X,te,Te){var _e=X<12?"AM":"PM";return Te?_e.toLowerCase():_e},le={YY:String(this.$y).slice(-2),YYYY:this.$y,M:k+1,MM:t.s(k+1,2,"0"),MMM:E(l.monthsShort,k,F,3),MMMM:E(F,k),D:this.$D,DD:t.s(this.$D,2,"0"),d:String(this.$W),dd:E(l.weekdaysMin,this.$W,B,2),ddd:E(l.weekdaysShort,this.$W,B,3),dddd:B[this.$W],H:String(R),HH:t.s(R,2,"0"),h:q(1),hh:q(2),a:Q(R,w,!0),A:Q(R,w,!1),m:String(w),mm:t.s(w,2,"0"),s:String(this.$s),ss:t.s(this.$s,2,"0"),SSS:t.s(this.$ms,3,"0"),Z:P};return p.replace(V,function(X,te){return te||le[X]||P.replace(":","")})},a.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},a.diff=function(o,b,l){var p,P=t.p(b),R=I(o),w=(R.utcOffset()-this.utcOffset())*n,k=this-R,B=t.m(this,R);return B=(p={},p[O]=B/12,p[_]=B,p[M]=B/3,p[d]=(k-w)/6048e5,p[v]=(k-w)/864e5,p[C]=k/u,p[A]=k/n,p[D]=k/h,p)[P]||k,l?B:t.a(B)},a.daysInMonth=function(){return this.endOf(_).$D},a.$locale=function(){return f[this.$L]},a.locale=function(o,b){if(!o)return this.$L;var l=this.clone(),p=z(o,b,!0);return p&&(l.$L=p),l},a.clone=function(){return t.w(this.$d,this)},a.toDate=function(){return new Date(this.valueOf())},a.toJSON=function(){return this.isValid()?this.toISOString():null},a.toISOString=function(){return this.$d.toISOString()},a.toString=function(){return this.$d.toUTCString()},s}(),g=r.prototype;return I.prototype=g,[["$ms",i],["$s",D],["$m",A],["$H",C],["$W",v],["$M",_],["$y",O],["$D",U]].forEach(function(s){g[s[1]]=function(a){return this.$g(a,s[0],s[1])}}),I.extend=function(s,a){return s.$i||(s(a,r,I),s.$i=!0),I},I.locale=z,I.isDayjs=m,I.unix=function(s){return I(1e3*s)},I.en=f[T],I.Ls=f,I.p={},I})})(ft);var wa=ft.exports;const je=ga(wa);const ya={class:"audio-player"},ba=["src"],$a={class:"progress-bar"},_a={class:"time-display"},Sa={class:"volume-control"},xa={__name:"audioPlay",props:{audioUrl:String},setup(e){const c=L(null),h=L(!1),n=L(0),u=L(0),i=L(0),D=L(1),A=L(!1);L(i.value);const C=L(1),v=()=>{h.value?c.value.pause():c.value.play(),h.value=!h.value},d=()=>{var V;A.value||(n.value=(V=c.value)==null?void 0:V.currentTime,i.value=n.value/u.value*100)},_=()=>{console.log("播放完"),h.value=!0,v()},M=()=>{u.value=c.value.duration},O=V=>{const x=Math.floor(V/60),Y=Math.floor(V%60);return`${x}:${Y.toString().padStart(2,"0")}`},U=V=>{C.value=V.target.value,c.value.volume=V.target.value},N=()=>{D.value===0?(c.value.volume=C.value,D.value=C.value):(c.value.volume=0,D.value=0)},S=V=>{h.value=!0,v(),c.value.currentTime=V/100*u.value,i.value=V};return fe(()=>{c.value.volume=D.value}),(V,x)=>{const Y=ne,y=ia;return ue(),pe("div",ya,[j("audio",{ref_key:"audioPlayer",ref:c,src:e.audioUrl,onTimeupdate:d,onEnded:_,onLoadedmetadata:M},null,40,ba),j("div",{class:"play-btn",onClick:v},[h.value?(ue(),He(Y,{key:1,name:"pause-circle"})):(ue(),He(Y,{key:0,name:"play-circle"}))]),j("div",$a,[$(y,{modelValue:i.value,"onUpdate:modelValue":x[0]||(x[0]=T=>i.value=T),"bar-height":"6px","button-size":"15px","active-color":"#fff","inactive-color":"#7b8458",onChange:S},null,8,["modelValue"])]),j("div",_a,Be(O(n.value))+" / "+Be(O(u.value)),1),j("div",Sa,[j("span",{onClick:N},[$(Y,{name:"volume"})]),Le(j("input",{type:"range","onUpdate:modelValue":x[1]||(x[1]=T=>D.value=T),min:"0",max:"1",step:"0.1",onInput:U},null,544),[[Mt,D.value]])])])}}},Ca=at(xa,[["__scopeId","data-v-d9f15beb"]]);const pa={class:"home text-center"},Da={key:0,class:"upload-box"},Pa={key:1,class:"audio-resouse"},Ma={class:"music-box"},Ta={class:"audition"},Ia=["src"],ka={__name:"AudioView",setup(e){const c=L(""),h=L(null),n=L(""),u=L(""),i=L([]),D=L(""),A=L(null),C=L(null),v=new(window.AudioContext||window.webkitAudioContext),d=L(null);L(null);const _=L(null);fe(()=>{M()});const M=()=>{c.value=je().format("YYYY-MM-DD HH:mm:ss"),h.value=setInterval(()=>{c.value=je().format("YYYY-MM-DD HH:mm:ss")},1e3)},O=()=>{if(!_.value){me("片段不能为空");return}jt({title:"下载提示：浏览器打开进行下载",message:`
        <a href="${D.value}" id="linkText" target="_blank">https://myd-website.github.io/audio/</a>
        <input
          style="width: 100%;"
          class="customFileName"
          value="${_.value}"
          type="text"
          colon
          placeholder="请输入文件名称"
        />`,allowHtml:!0,theme:"round-button"}).then(()=>{const f=document.getElementsByClassName("customFileName")[0].value;if(f)_.value=f.includes("mp3")?f:`${f}.mp3`,U(),N();else{me("文件名称不能为空");return}})},U=async()=>{const f=document.createRange();f.selectNode(document.querySelector("#linkText"));const m=window.getSelection();m.rangeCount>0&&m.removeAllRanges(),m.addRange(f),document.execCommand("Copy"),me("复制成功")},N=f=>{const m=document.createElement("a");m.href=D.value,m.download=_.value,m.click()},S=f=>(console.log(f,"file上传中"),f.status="uploading",f.message="上传中...",!0),V=f=>{console.log(f,"file上传成功"),u.value=f.file.name,n.value=URL.createObjectURL(f.file),Y(f.file)},x=f=>{console.log(f,"file上传成功"),u.value="",n.value="",i.value=[]},Y=f=>{if(!f)return;const m=new FileReader;m.onload=async()=>{const z=m.result;d.value=await v.decodeAudioData(z)},m.readAsArrayBuffer(f)},y=async(f,m)=>{const z=i.value[0];if(!z.file){me("请先选择一个音频文件");return}if(Number(f)>=Number(m)){me("请输入有效的时间段");return}const I=new(window.AudioContext||window.webkitAudioContext),t=await z.file.arrayBuffer(),r=await I.decodeAudioData(t),g=2,s=(m-f)*r.sampleRate,a=r.sampleRate,o=I.createBuffer(g,s,a);for(let l=0;l<r.numberOfChannels;l++){const p=r.getChannelData(l);o.getChannelData(l).set(p.subarray(f*r.sampleRate,m*r.sampleRate))}const b=await T(o);D.value=URL.createObjectURL(b),_.value=`[${f}秒~${m}秒片段]_${u.value}`};function T(f){let m=f.numberOfChannels,z=f.length*m*2+44,I=0,t=new DataView(new ArrayBuffer(z)),r=[],g,s,a=0;for(b(1179011410),b(z-8),b(1163280727),b(544501094),b(16),o(1),o(m),b(f.sampleRate),b(f.sampleRate*2*m),o(m*2),o(16),b(1635017060),b(z-a-4),g=0;g<f.numberOfChannels;g++)r.push(f.getChannelData(g));for(;a<z;){for(g=0;g<m;g++)s=Math.max(-1,Math.min(1,r[g][I])),s=(.5+s<0?s*32768:s*32767)|0,t.setInt16(a,s,!0),a+=2;I++}return new Blob([t],{type:"audio/wav"});function o(l){t.setUint16(a,l,!0),a+=2}function b(l){t.setUint32(a,l,!0),a+=4}}return Pe(()=>{clearInterval(h)}),(f,m)=>{const z=At,I=ma,t=ne,r=It,g=Tt,s=Bt;return ue(),pe("div",pa,[$(z,{"left-icon":"volume-o",text:`当前时间：${c.value}`},null,8,["text"]),n.value?We("",!0):(ue(),pe("div",Da,[m[4]||(m[4]=j("p",{class:"mg10"},"请上传音频文件：",-1)),$(I,{modelValue:i.value,"onUpdate:modelValue":m[0]||(m[0]=a=>i.value=a),"max-count":1,"before-read":S,"after-read":V,"before-delete":x,accept:"audio/mp3"},null,8,["modelValue"])])),n.value?(ue(),pe("div",Pa,[j("span",null,Be(u.value),1),j("div",Ma,[j("div",{class:"close",onClick:x},[$(t,{name:"clear"})]),$(Ca,{audioUrl:n.value},null,8,["audioUrl"])]),$(g,{inset:""},{default:Ie(()=>[$(r,{modelValue:A.value,"onUpdate:modelValue":m[1]||(m[1]=a=>A.value=a),type:"number",colon:"",placeholder:"请输入开始时间",label:"开始时间/秒"},null,8,["modelValue"]),$(r,{modelValue:C.value,"onUpdate:modelValue":m[2]||(m[2]=a=>C.value=a),type:"number",colon:"",placeholder:"请输入结束时间",label:"结束时间/秒"},null,8,["modelValue"])]),_:1}),$(s,{type:"success",onClick:m[3]||(m[3]=a=>y(A.value,C.value))},{default:Ie(()=>m[5]||(m[5]=[ke("截取片段")])),_:1}),j("p",Ta,[m[6]||(m[6]=ke(" 试听： ")),j("audio",{src:D.value,controls:"",autoplay:"false"},null,8,Ia)]),$(s,{type:"success",onClick:O},{default:Ie(()=>m[7]||(m[7]=[ke("下载")])),_:1})])):We("",!0)])}}},Ea=at(ka,[["__scopeId","data-v-c1933767"]]);export{Ea as default};
